{
  "hash": "c9f74b2e6530ee61b489eabcbbb5db04",
  "result": {
    "markdown": "---\ntitle: Derivadas de funciones de varias variables\ncrossref:\n    chapters: true\nexecute: \n  echo: false\n  cache: true\n  freeze: auto\n  daemon: 3600\nlang: es\n---\n\n::: {.content-visible unless-format=\"pdf\"}\n::: {.hidden}\n$$\n\\newcommand{\\mathbb{N}}{\\mathbb{N}}\n\\newcommand{\\mathbb{Z}}{\\mathbb{Z}}\n\\newcommand{\\mathbb{Q}}{\\mathbb{Q}}\n\\newcommand{\\mathbb{R}}{\\mathbb{R}}\n\\newcommand{\\mathbb{C}}{\\mathbb{C}}\n\\DeclareMathOperator{\\Int}{Int}\n\\DeclareMathOperator{\\Ext}{Ext}\n\\DeclareMathOperator{\\Fr}{Fr}\n\\DeclareMathOperator{\\Adh}{Adh}\n\\DeclareMathOperator{\\Ac}{Ac}\n\\DeclareMathOperator{\\sen}{sen}\n$$\n:::\n\n\n:::\n\nHasta ahora hemos estado estudiando funciones que dependían de una sola variable independiente, pero en muchos casos de la vida real aparecen funciones que dependen de más de una variable, como por ejemplo\n\n- El área de un triángulo depende de dos factores que son su base y su altura.\n- El volumen que ocupa un gas perfecto depende de dos factores que son su presión y su temperatura.\n- El capital de una inversión depende de el tiempo y el tipo de interés.\n- El camino recorrido por un cuerpo en un movimiento de caída libre depende de multitud de factores entre los que cabe destacar: el tiempo que dure la caída, el área de la sección transversal del cuerpo, la latitud del lugar, la altura sobre el nivel del mar, la presión del aire, la temperatura del aire, etc.\n\nEstas dependencias se expresan con funciones de varias variables. \nEn este capítulo analizaremos las derivadas este tipo de funciones, en particular funciones de $\\mathbb{R}^2$ en $\\mathbb{R}$ y de $\\mathbb{R}^3$ en $\\mathbb{R}$, aunque los resultados se pueden generalizar fácilmente para funciones de $\\mathbb{R}^n$ en $\\mathbb{R}$.\n\n## Función de varias variables\n\n:::{#def-funcion-varias-variables}\n## Función de varias variables\nUna *función de $n$ variables* de un conjunto $A_1\\times \\cdots \\times A_n$ en un conjunto $B$, es una relación que asocia a cada tupla $(a_1,\\ldots,a_n)\\in A_1\\times \\cdots\\times A_n$ un único elemento de $B$ que se denota $f(a_1,\\ldots,a_n)$, y se llama imagen de $(a_1,\\ldots,a_n)$ mediante $f$.\n\n$$\n\\begin{array}{lccc}\nf: & A_1\\times\\cdots\\times A_n & \\longrightarrow & B \\\\\n   &(a_1,\\ldots,a_n) & \\longrightarrow & f(a_1,\\ldots,a_n)\n\\end{array}\n$$\n\nCuando $A_1,\\ldots,A_n,B\\subseteq \\mathbb{R}$, entonces se dice que $f$ es una _función real de $n$ variables reales_ o bien un *campo escalar*.\n:::\n\n:::{#exm-funciones-varias-variables}\n\n- El área de un triángulo es la función real de dos variables reales\n\n$$f(x,y)=\\frac{xy}{2}.$$\n\n- El volumen de un gas perfecto es otra función real de dos variables\n\n\t$$v=f(t,p)=\\frac{nRt}{p},$$\n\n\tcon $n$ y $R$ constantes.\n:::\n\n### Gráfica de una función de dos variables\n\nLa representación gráfica cartesiana de una función de dos variables $f(x,y)$ es una superficie del espacio real $\\mathbb{R}^3$ donde cada punto de la superficie tiene coordenadas $(x,y,z)$, siendo $z=f(x,y)$.\n\n<!-- ```{julia}\nusing WGLMakie\nxs = range(-2, 2, 200)\nys = range(-2, 2, 200)\nzs = [x^2 + y^2 for x in xs, y in ys]\nsurface(xs, ys, zs, axis=(type=Axis3,))\n``` -->\n\n:::{.content-visible when-format=\"html\"}\n![Representación gráfica de una función de dos variables.](img/derivadas-funciones-varias-variables/grafica-funcion-dos-variables.png)\n:::\n\n:::{.content-visible unless-format=\"html\"}\n![Representación gráfica de una función de dos variables.](img/derivadas-funciones-varias-variables/grafica-funcion-dos-variables.pdf)\n:::\n\n:::{#exm-graficas-funciones-dos-variables}\nLa función $f(x,y)=\\dfrac{xy}{2}$ que mide el área de un triángulo de base $x$ y altura $y$ tiene la siguiente representación gráfica:\n\n:::{.content-visible when-format=\"html\"}\n![Gráfica de la función que mide el área de un triángulo.](img/derivadas-funciones-varias-variables/superficie-funcion-area-triangulo.png)\n:::\n\n:::{.content-visible unless-format=\"html\"}\n![Gráfica de la función que mide el área de un triángulo.](img/derivadas-funciones-varias-variables/superficie-funcion-area-triangulo.pdf)\n:::\n\nY la función $\\displaystyle f(x,y)=\\frac{\\operatorname{sen}(x^2+y^2)}{\\sqrt{x^2+y^2}}$ tiene la siguiente representación gráfica que simula las ondas que produce una gota de agua al caer sobre un líquido.\n\n:::{.content-visible when-format=\"html\"}\n![Gráfica de la función que representa las ondas creadas por una gota de agua.](img/derivadas-funciones-varias-variables/superficie-ondas.png)\n:::\n\n:::{.content-visible unless-format=\"html\"}\n![Gráfica de la función que representa las ondas creadas por una gota de agua.](img/derivadas-funciones-varias-variables/superficie-ondas.pdf)\n:::\n\n### Conjunto de nivel de un campo escalar\n\nVisualizar la gráfica de una función de dos variables no es fácil, sobre todo si se representa en un papel que, a fin de cuentas, es un plano en dos dimensiones. Un recurso bastante habitual para entender el comportamiento de una función de dos variables son las curvas de nivel, que consisten en representar en el plano euclídeo los puntos $(x,y)$ que tienen la misma imagen.\n\n:::{#def-conjunto-nivel}\n## Conjunto de nivel\nDada una función de $n$ variables $f:\\mathbb{R}^n\\rightarrow \\mathbb{R}$, se llama *conjunto de nivel* $c$ de $f$ al conjunto\n\n$$\nC_{f,c}=\\{(x_1,\\ldots,x_n): f(x_1,\\ldots,x_n)=c\\}.\n$$\n:::\n\n:::{#exm-conjunto-nivel}\nSi $f(x,y)=x^2+y^2$ y $P=(1,1)$, el conjunto de nivel de $f$ que incluye al punto $P$ es\n\n$$\nC_{f,2} = \\{(x,y): f(x,y)=f(1,1)=2\\} = \\{(x,y): x^2+y^2=2\\},\n$$\n\nque es la circunferencia del plano real centrada en el origen y de radio $\\sqrt{2}$.\n\n:::{.content-visible when-format=\"html\"}\n![Gráfica del conjunto de nivel de un paraboloide.](img/derivadas-funciones-varias-variables/curva-nivel.png)\n:::\n\n:::{.content-visible unless-format=\"html\"}\n![Gráfica del conjunto de nivel de un paraboloide.](img/derivadas-funciones-varias-variables/curva-nivel.pdf)\n:::\n:::\n\n:::{#exm-curvas-nivel}\nLa siguiente gráfica representa algunas de las curvas de nivel de la función $f(x,y) = y^2-x^2$. \n\n::: {.cell execution_count=1}\n\n::: {.cell-output .cell-output-display execution_count=2}\n![Gráfica y curvas de nivel de la función $f(x,y)=y^2-x^2$.](13-derivadas-funciones-varias-variables_files/figure-pdf/cell-2-output-1.pdf){}\n:::\n:::\n\n\n:::\n\nLas curvas de nivel se utilizan en muchas aplicaciones como por ejemplo en los mapas topográficos, donde cada curva representa los puntos que están a la misma altura sobre el nivel del mar, o en los mapas meteorológicos, donde cada curva representa los puntos con la misma presión atmosférica.\n\n::: {.content-visible when-format=\"html\"}\n::: {layout-ncol=2}\n![Curvas de nivel de un mapa topográfico.](./img/derivadas-funciones-varias-variables/mapa-topografico.jpg)\n\n![Curvas de nivel de un mapa de presión atmosférica.](./img/derivadas-funciones-varias-variables/mapa-isobaras.jpg)\n:::\n:::\n\n::: {.content-visible unless-format=\"html\"}\n::: {layout-ncol=2}\n![Curvas de nivel de un mapa topográfico.](./img/derivadas-funciones-varias-variables/mapa-topografico.jpg)\n\n![Curvas de nivel de un mapa de presión atmosférica.](./img/derivadas-funciones-varias-variables/mapa-isobaras.jpg)\n:::\n:::\n\n## Límites y continuidad\n\nEl concepto de límite de una función de una variable se puede extender fácilmente a funciones de varias variables, pero antes necesitamos introducir, desde un punto de vista topológico, el concepto equivalente a un entorno de un punto en la recta real, en espacios de mayor dimensión.\n\n:::{#def-entorno-punto-plano}\n## Entorno de un punto en el plano real\nDado un punto del plano $(x_0,y_0)\\in \\mathbb{R}^2$, se llama _entorno_ de $(x_0,y_0)$ a cualquier disco abierto $\\{(x,y):\\sqrt{(x-x_0)^2+(y-y_0)^2}<\\varepsilon\\}$ con $\\varepsilon>0$. El número $\\varepsilon$ se conoce como _radio del entorno_.\n\nPara cualquier $\\varepsilon>0$ el conjunto $\\{(x,y):\\sqrt{(x-x_0)^2+(y-y_0)^2}<\\varepsilon\\}\\setminus \\{(x_0,y_0)\\}$ se llama _entorno reducido_ de $(x_0,y_0)$.\n:::\n\nGeométricamente, un entorno de $(x_0,y_0)$ de radio $\\varepsilon$ está formado por todos los puntos interiores del círculo de radio $\\varepsilon$ centrado en $(x_0,y_0)$.\n\n:::{.content-visible when-format=\"html\"}\n![Entorno de un punto en el plano.](img/derivadas-funciones-varias-variables/entorno-punto-plano.png)\n:::\n\n:::{.content-visible unless-format=\"html\"}\n![Entorno de un punto en el plano.](img/derivadas-funciones-varias-variables/entorno-punto-plano.pdf)\n:::\n:::\n\nDe manera similar se define un entorno en el espacio real.\n\n:::{#def-entorno-punto-espacio}\n## Entorno de un punto en el espacio real\nDado un punto del espacio $(x_0,y_0,z_0)\\in \\mathbb{R}^3$, se llama _entorno_ de $(x_0,y_0z_0)$ a cualquier bola abierta $\\{(x,y,z):\\sqrt{(x-x_0)^2+(y-y_0)^2+(z-z_0)^2}<\\varepsilon\\}$ con $\\varepsilon>0$. El número $\\varepsilon$ se conoce como _radio del entorno_.\n\nPara cualquier $\\varepsilon>0$ el conjunto $\\{(x,y,z):\\sqrt{(x-x_0)^2+(y-y_0)^2+(z-z_0)^2}<\\varepsilon\\}\\setminus \\{(x_0,y_0,z_0)\\}$ se llama _entorno reducido_ de $(x_0,y_0,z_0)$.\n:::\n\nGeométricamente, un entorno de $(x_0,y_0,z_0)$ de radio $\\varepsilon$ está formado por todos los puntos interiores de la esfera de radio $\\varepsilon$ centrado en $(x_0,y_0,z_0)$.\n\n:::{.content-visible when-format=\"html\"}\n![Entorno de un punto en el espacio.](img/derivadas-funciones-varias-variables/entorno-punto-espacio.png)\n:::\n\n:::{.content-visible unless-format=\"html\"}\n![Entorno de un punto en el espacio.](img/derivadas-funciones-varias-variables/entorno-punto-espacio.pdf)\n:::\n\n:::{#def-limite-funcion-varias-variables}\n## Límite de una función de varias variables\nDada una función de $n$ variables $f:\\mathbb{R}^n\\rightarrow \\mathbb{R}$ definida en un entorno reducido del punto $(a_1, \\ldots, a_n)$, se dice que $l$ es el _límite_ de $f$ en el punto $(a_1, \\ldots, a_n)$, si para cada $\\varepsilon>0$ existe un $\\delta>0$ tal que si $0<\\sqrt{(x_1-a_1)^2+\\cdots+(x_n-a_n)^2}<\\delta$, entonces $|f(x_1,\\ldots,x_n)-l|<\\varepsilon$, y en tal caso, se denota\n\n$$\n\\lim_{(x_1,\\ldots,x_n)\\rightarrow (a_1,\\ldots,a_n)}f(x_1,\\ldots,x_n) = l.\n$$\n:::\n\nEn el caso de una función de una variable $f(x)$, vimos que para que existiese el límite de la función en el punto $a$, bastaba con ver que existía el límite por la izquierda (cuando nos aproximamos a $a$ con valores menores que $a$) y el límite por la derecha (cuando nos aproximamos a $a$ con valores mayores que $a$) y que eran iguales. Sin embargo, para funciones de varias variables esto no es así, ya que para demostrar la existencia del límite es necesario probar que el límite existe cuando nos acercamos a $(x_0,\\ldots,y_0)$ por cualquier posible trayectoria en $\\mathbb{R}^n$, y todos los límites coinciden.\n\n:::{#exm-no-existencia-limite}\nEl límite de la función $f(x,y)=\\dfrac{xy}{x^2+y^2}$ en $(0,0)$ no existe, ya que si nos aproximamos a $(0,0)$ tomando puntos de la recta $y=mx$, tenemos\n\n\\begin{align*}\n\\lim_{(x,mx)\\to(0,0)} f(x,mx) \n&= \\lim_{x\\to 0} \\frac{xmx}{x^2+(mx)^2} \n= \\lim_{x\\to 0} \\frac{mx^2}{(m^2+1)x^2} \\\\\n& \\lim_{x\\to 0} \\frac{m}{m^2+1} \n= \\frac{3m}{m^2+1},\n\\end{align*}\n\nque nos da un límite distinto para cada $m$, es decir, para cada dirección de aproximación obtenemos un límite distinto.\n:::\n\n:::{.callout-caution}\nLa estrategia de calcular el límite a lo largo de las trayectorias rectas $y=y_0+m(x-x0)$ que pasan por el punto $(x_0,y_0)$ no garantiza la existencia del límite, aún cuando todos los límites existan y sean iguales. \n:::\n\n:::{#exm-no-existencia-limite-2}\nPara la función $f(x,y)=\\frac{\\operatorname{sen}(xy)}{x+y}$, si nos aproximamos a $(0,0)$ tomando los puntos de la recta $y=mx$, se tiene\n\n\\begin{align*}\n\\lim_{(x,mx)\\to(0,0)} f(x,mx) \n&= \\lim_{x\\to 0} \\frac{\\operatorname{sen}(xmx)}{x+mx} \\\\\n&= \\lim_{x\\to 0} \\frac{\\operatorname{sen}(mx^2)}{(m+1)x} \\\\\n& \\lim_{x\\to 0} \\frac{m2x\\cos(mx^2)}{m+1} \\tag{L'Hôpital} \n= 0.\n\\end{align*}\n\nPor tanto, el límite existe y valeo $0$ cuando nos aproximamos a $(0,0)$ siguiendo trayectorias rectas. Sin embargo, existen otras trayectorias de aproximación donde el límite no existe, como por ejemplo, la trayectoria $y=-\\operatorname{sen}(x)$.\n\n\\begin{align*}\n\\lim_{(x,-\\operatorname{sen}(x))\\to(0,0)} f(x,-\\operatorname{sen}(x)) \n&= \\lim_{x\\to 0} \\frac{\\operatorname{sen}(-x\\operatorname{sen}(x))}{x-\\operatorname{sen}(x)} \\\\\n&= \\lim_{x\\to 0} \\frac{\\cos(-x\\operatorname{sen}(x))(-\\operatorname{sen}(x)-x\\cos(x))}{1-\\cos(x)}  \\tag{1} \\\\\n&= \\lim_{x\\to 0} \\frac{-\\operatorname{sen}(-x\\operatorname{sen}(x))(-\\operatorname{sen}(x)-x\\cos(x))^2+\\cos(-x\\operatorname{sen}(x))(-2\\cos(x)+x\\operatorname{sen}(x))}{\\operatorname{sen}(x)}  \\tag{2} \\\\\n&= \\infty.\n\\end{align*}\n(1 y 2) Aplicando la regla de L'Hôpital.\n\nPor consiguiente, no existe el límite de $f$ en $(0,0)$.\n:::\n\nAfortunadamente, el álgebra de límites visto en la @prp-limite-suma-resta-producto-cociente-funciones también es válido para funciones de varias variables. \n\n:::{#exm-algebra-limites-funciones-varias-variables}\nEl límite de la función $f(x,y)=\\frac{3xy^2}{x^2+y^3}$ en el punto $(2,1)$ es\n\n\\begin{align*}\n\\lim_{(x,y)\\to(2,1)} f(x,y) \n&= \\lim_{(x,y)\\to(2,1)} \\frac{3xy^2}{x^2+y^3} \\\\\n&= \\frac{\\lim_{(x,y)\\to(2,1)} 3xy^2}{\\lim_{(x,y)\\to(2,1)} x^2+y^3} \\\\\n&= \\frac{3\\lim_{(x,y)\\to(2,1)} x\\lim_{(x,y)\\to(2,1)}y^2}{\\lim_{(x,y)\\to(2,1)} x^2+\\lim_{(x,y)\\to(2,1)}y^3} \\\\\n&= \\frac{3\\cdot 2\\cdot 1^2}{2^2 + 1^3} \n= \\frac{6}{5}.\n\\end{align*}\n:::\n\n### Función continua\n\nUna vez definido el límite de una función de varias variables, el concepto de continuidad se extiende de manera natural a funciones de varias variables.\n\n:::{#def-funcion-varias-variables-continua}\nDada una función de $n$ variables $f:\\mathbb{R}^n\\rightarrow \\mathbb{R}$, se dice que $f$ es _continua_ en el punto $(a_1, \\ldots, a_n)$ si \n\n$$\n\\lim_{(x_1,\\ldots,x_n)\\rightarrow (a_1,\\ldots,a_n)}f(x_1,\\ldots,x_n) = f(a_1,\\ldots, a_n).\n$$\n:::\n\n### Funciones parciales\n\n:::{#def-funcion-parcial}\n## Función parcial\nDada una función de $n$ variables $f:\\mathbb{R}^n\\rightarrow \\mathbb{R}$, se llama *función parcial* $i$-esima de $f$ a cualquier función $f_i:\\mathbb{R}\\rightarrow \\mathbb{R}$ que resulta de fijar todas las variables de $f$ como constantes, excepto la variable $i$, es decir:\n\n$$f_i(x)=f(c_1,\\ldots,c_{i-1},x,c_{i+1},\\ldots,c_{n}),$$\n\ncon $c_j$ $(j=1,\\ldots, n,\\ j\\neq i)$ constantes.\n:::\n\n:::{#exm-funcion-parcial}\nSi consideramos la función del área de un triángulo\n\n$$f(x,y)=\\frac{xy}{2},$$\n\ny fijamos el valor de la base $x=c$, entonces el área del triángulo ya sólo depende de la altura y $f$ se convierte en una función de una sola variable, que es la función parcial:\n\n$$\nf_1(y)=f(c,y)=\\frac{cy}{2},\n$$\n\ncon $c$ constante.\n:::\n\n## Derivadas parciales\n\nAl igual que vimos cómo calcular la variación de una función de una variable, tiene sentido medir la variación de una función de varias variables con respecto a cada una de sus variables.\n\nSea $f(x,y)$ una función de varias variables de $\\mathbb{R}^2$. Si estamos en el punto $(x_0,y_0)$ y nos movemos una cantidad $\\Delta x$ en la dirección del eje $X$, entonces, al mantenerse la coordenada $y$ constante, pasaremos desde el punto $(x_0,y_0)$ al punto $(x_0+\\Delta x,y_0)$, y la variación que experimenta la función será\n\n$$\\Delta z=f(x_0+\\Delta x,y_0)-f (x_0,y_0).$$\n\nLa variación relativa que experimenta la función con respecto a la variable $x$ vendrá dada por el cociente\n\n$$\\frac{\\Delta z}{\\Delta x}=\\frac{f(x_0+\\Delta x,y_0)-f(x_0,y_0)}{\\Delta x}.$$\n\nSi en lugar de medir la variación de una función con respecto a una variable en un intervalo, medimos la variación en un punto, es decir, cuando $\\Delta x$ tiende a 0, entonces obtenemos una tasa de variación instantánea:\n\n$$\\lim_{\\Delta x\\rightarrow 0}\\frac{\\Delta z}{\\Delta x}=\\lim_{\\Delta x \\rightarrow 0}\\frac{f(x_0+\\Delta x,y_0)-f(x_0,y_0)}{\\Delta x}.$$\n\nAl valor del límite, cuando existe, también se le conoce como *derivada parcial* de $f$ con respecto a la variable $x$ en el punto $(x_0,y_0)$ y se nota\n\n$$\\frac{\\partial f}{\\partial x}(x_0,y_0).$$\n\nEsta derivada parcial mide la tasa de variación instantánea de $f$ en el punto $P=(x_0,y_0)$ cuando $P$ se mueve en la dirección del eje $X$.\n\n### Interpretación geométrica de la derivada parcial\n\nGeométricamente, $z=f(x,y)$ define una superficie. Si se corta esta superficie con el plano de ecuación $y=y_0$ (es decir, si $y$ se fija como una constante), la intersección de este plano con la superficie es una curva plana cuya pendiente en el punto $(x_0,y_0)$ es la derivada parcial de $f$ con respecto a $x$ en el punto $(x_0,y_0)$.\n\n<!-- :::{.content-visible when-format=\"html\"}\n![Gráfica de la tangente a la intersección de una superficie con un plano](img/derivadas-funciones-varias-variables/grafica_tangente_parcial.png)\n:::\n\n:::{.content-visible unless-format=\"html\"}\n![Gráfica de la tangente a la intersección de una superficie con un plano](img/derivadas-funciones-varias-variables/grafica_tangente_parcial.pdf)\n::: -->\n\nEl concepto de derivada parcial visto para funciones de dos variables puede extenderse fácilmente para funciones de $n$ variables.\n\n:::{#def-derivada-parcial}\n## Derivada parcial\nDada una función de $n$ variables $f(x_1,\\ldots,x_n)$, se dice que $f$ es *derivable parcialmente* con respecto a la variable $x_i$ en el punto $a=(a_1,\\ldots,a_n)$ si existe el límite\n\n$$\n\\lim_{h\\rightarrow 0} \\frac{f(a_1,\\ldots,a_{i-1},a_i+h,a_{i+1},\\ldots,a_n)-f(a_1,\\ldots,a_{i-1},a_i,a_{i+1},\\ldots,a_n)} {h}.\n$$\n\nEn tal caso, al valor del límite se le llama _derivada parcial_ de $f$ en $a$ con respecto a la variable $x_i$, y se denota\n\n$$\nf'_{x_i}(a)=\\frac{\\partial f}{\\partial x_i}(a).\n$$\n:::\n\nComo se puede observar, la definición de derivada para funciones de una variable es un caso particular de esta definición para $n=1$.\n\n\nAl medir la variación de $f$ con respecto a la variación de una sola de sus variables $x_i$ en un punto $a=(a_1,\\ldots,a_n)$, el resto de las variables se pueden considerar como constantes y, en tal caso, podemos ver a $f$ como una función parcial $i$-ésima\n\n$$f_i(x_i)=f(a_1,\\ldots,a_{i-1},x_i,a_{i+1},\\ldots,a_n).$$\n\nLa derivada parcial de $f$ con respecto a $x_i$ puede calcularse derivando esta función:\n\n$$\\frac{\\partial f}{\\partial x_i}(a)=f_i'(a_i).$$\n\n>**Regla**. Para derivar parcialmente $f(x_1,\\ldots,x_n)$ con respecto a una variable $x_i$, se deriva $f$ como si la única variable fuese $x_i$, tratando el resto de las variables como constantes.\n\n**Ejemplo** En la ecuación de estado de los gases perfectos, el volumen es una función que depende de dos variables\n\n$$v(t,p)=\\frac{nRt}{p},$$\n\ndonde $t$ mide la temperatura, $p$ la presión y $n$ y $R$ son constantes.\n\nLa tasa de variación instantánea que experimenta el volumen con respecto a la presión viene dada por la derivada parcial de $v$ con respecto a $p$.\n\nPara calcular esta derivada parcial se fija $t$ como constante y se deriva $v$ como si la única variable fuese $p$:\n\n$$\\frac{\\partial v}{\\partial p}(t,p)=\\frac{d}{dp}\\left(\\frac{nRt}{p}\\right)_{\\mbox{$t=$cte}}=\\frac{-nRt}{p^2}.$$\n\nDel mismo modo, la tasa de variación instantánea del volumen con respecto a la temperatura es:\n\n$$\\frac{\\partial v}{\\partial t}(t,p)=\\frac{d}{dt}\\left(\\frac{nRt}{p}\\right)_{\\mbox{$p=$cte}}=\\frac{nR}{p}.$$\n\n## Vector gradiente\n\n:::{#def-vector-gradiente}\n## Vector gradiente\nDado un campo escalar $f(x_1,\\ldots,x_n)$, se llama *gradiente* de $f$, y se escribe $\\nabla f$, a la función que a cada punto $a=(a_1,\\ldots,a_n)$ le asigna el vector cuyas coordenadas cartesianas son las derivadas parciales de $f$ en $a$,\n\n$$\\nabla f(a)=\\left(\\frac{\\partial f}{\\partial x_1}(a),\\ldots,\\frac{\\partial f}{\\partial x_n}(a)\\right).$$\n:::\n\nMás adelante se mostrará que vector gradiente en un punto dado tiene la misma magnitud y dirección que la velocidad máxima de variación de la función en ese punto.\n\nDe este modo, , mientras que $-\\nabla f(a)$ indica la dirección de máximo decrecimiento.\n\n:::{#exm-vector-gradiente}\nAl calentar una superficie la temperatura $t$ (en ºC) en cada punto $(x,y,z)$ (en m) de dicha superficie viene dada por la función:\n\n$$\nt(x,y,z)=\\frac{x}{y}+z^2.\n$$\n\nLa dirección en la que más rápidamente aumenta la temperatura nos la da el vector gradiente\n\n$$\n\\nabla t(x,y,z)=\\left(\\frac{\\partial t}{\\partial x}(x,y,z),\\frac{\\partial t}{\\partial y}(x,y,z),\\frac{\\partial t}{\\partial\nz}(x,y,z)\\right)=\\left(\\frac{1}{y},\\frac{-x}{y^2},2z\\right).\n$$\n\nSi estamos, por ejemplo, en el punto $(2,1,1)$ dicha dirección será\n\n$$\n\\nabla t(2,1,1)=\\left(\\frac{1}{1},\\frac{-2}{1^2},2\\cdot 1\\right)=(1,-2,2),\n$$\n\ny su magnitud\n\n$$\n|\\nabla f(2,1,1)|=|\\sqrt{1^2+(-2)^2+2^2}|=|\\sqrt{9}|=3 \\mbox{ $^\\circ$C/m}.\n$$\n:::\n\n### Regla de la cadena\n\nSi $f:\\mathbb{R}^n\\rightarrow \\mathbb{R}$ es un campo escalar y $g:\\mathbb{R}\\rightarrow \\mathbb{R}^n$ es una trayectoría, entonces es posible componer $g$ con $f$, de manera que $f\\circ g:\\mathbb{R}\\rightarrow \\mathbb{R}$ es una función real de variable real.\n\n>**Teorema - Regla de la cadena**. Si $f:\\mathbb{R}^n\\rightarrow \\mathbb{R}$ es un campo escalar y $g:\\mathbb{R}\\rightarrow \\mathbb{R}^n$ es una trayectoría, entonces\n\n$$(f\\circ g)'(t) = \\nabla f(g(t))\\cdot g'(t).$$\n\n:::{#exm-regla-cadena}\nSi se toma el campo escalar del plano real $f(x,y)=x^2y$ y la trayectoria $g(t)=(\\cos t,\\operatorname{sen} t)$ $t\\in [0,2\\pi]$ del mismo plano, entonces\n\n$$\\nabla f(x,y) = (2xy, x^2) \\quad  \\mbox{y} \\quad g'(t) = (-\\operatorname{sen} t, \\cos t),$$\n\ny\n\n$$(f\\circ g)'(t) = \\nabla f(g(t))\\cdot g'(t) = (2\\cos t\\operatorname{sen} t,\\cos^2 t)\\cdot (-\\operatorname{sen} t,\\cos t) = -2\\cos t\\operatorname{sen}^2 t+\\cos^3 t.$$\n\nSe puede llegar al mismo resultado, sin aplicar la regla de la cadena, derivando directamente la función compuesta\n\n$$(f\\circ g)(t) = f(g(t)) = f(\\cos t, \\operatorname{sen} t) = \\cos^2 t\\operatorname{sen} t,$$\n\nde manera que\n\n$$(f\\circ g)'(t) = 2\\cos t(-\\operatorname{sen} t)\\operatorname{sen} t+\\cos^2 t \\cos t = -2\\cos t\\operatorname{sen}^2 t+\\cos^3 t.$$\n:::\n\nLa regla de la cadena para la composición de un campo escalar con una trayectoria permite obtener fácilmente el álgebra de derivadas para funciones reales de una variable real:\n\n$$\n\\begin{aligned}\n(u+v)' &= u'+v'\\\\\n(uv)' &= u'v+uv'\\\\\n\\left(\\frac{u}{v}\\right)' &= \\frac{u'v-uv'}{v^2}\\\\\n(u\\circ v)' &= u'(v)v'\n\\end{aligned}\n$$\n\nPara deducir la derivada de la suma se toma el campo escalar $f(x,y)=x+y$ y la trayectoria $g(t)=(u(t),v(t))$, de manera que aplicando la regla de la cadena se tiene\n\n$$(u+v)'(t) = (f\\circ g)'(t) = \\nabla f(g(t))\\cdot g'(t) = (1,1)\\cdot (u'(t),v'(t)) = u'(t)+v'(t).$$\n\ny para deducir derivada del producto, tomando $f(x,y)=xy$, se tiene\n\n$$(uv)'(t) = (f\\circ g)'(t) = \\nabla f(g(t))\\cdot g'(t) = (v(t),u(t))\\cdot (u'(t),v'(t)) = u'(t)v(t)+u(t)v'(t).$$\n\n## Derivada direccional\n\nPara un campo escalar $f(x,y)$ de $\\mathbb{R}^2$ y un punto $P=(x_0,y_0)$, se vió que $\\dfrac{\\partial f}{\\partial x}$ es la tasa de variación instantánea de $f$ con respecto a $x$ en el punto $P$, es decir, cuando nos desplazamos desde el punto $P$ en la dirección del eje $X$.\n\nDel mismo modo, $\\dfrac{\\partial f}{\\partial y}$ es la tasa de variación instantánea de $f$ con respecto a $y$ en el punto $P$, es decir, cuando nos desplazamos desde el punto $P$ en la dirección del eje $Y$.\n\nPero, *¿qué pasa si nos movemos en cualquier otra dirección?*\n\nLa tasa de variación instantánea de $f$ en un punto $P$ en la dirección de un vector unitario cualquiera $u$ se conoce como *derivada direccional*.\n\n:::{#def-derivada-direccional}\n## Derivada direccional\nDado un campo escalar $f$ de $\\mathbb{R}^n$, un punto $P$ y un vector unitario $\\mathbf{u}$ en ese espacio, el límite\n\n$$\nf'_{\\mathbf{u}}(P) = \\lim_{h\\rightarrow 0}\\frac{f(P+h\\mathbf{u})-f(P)}{h},\n$$\n\ncuando existe, se llama *derivada direccional* de $f$ en el punto $P$ en la dirección de $\\mathbf{u}$.\n:::\n\nSi se considera un vector unitario $\\mathbf{u}$, la trayectoria que pasa por $P$, dirigida por $\\mathbf{u}$, tiene ecuación\n\n$$\ng(t)=P+t\\mathbf{u},\\ t\\in\\mathbb{R},\n$$ \n\nque para $t=0$, pasa por $P=g(0)$ con velocidad $\\mathbf{u}=g'(0)$.\n\nAsí, la tasa de variación de $f$ a partir del punto $P$ en la dirección de $\\mathbf{u}$ es\n\n$$\n(f\\circ g)'(0) = \\nabla f(g(0))\\cdot g'(0) = \\nabla f(P)\\cdot \\mathbf{u}.\n$$\n\nObsérvese que las derivadas parciales son las derivadas direccionales en las direcciones de los vectores coordenados.\n\n:::{#exm-derivada-direccional}\nDada la función $f(x,y) = x^2+y^2$, su vector gradiente es\n\n$$\n\\nabla f(x,y) = (2x,2y),\n$$\n\nde manera que la derivada direccional en el punto $P=(1,1)$, en la dirección del vector unitario $\\mathbf{u}=(1/\\sqrt{2},1/\\sqrt{2})$ es\n\n$$\nf'_{\\mathbf{u}}(P) = \\nabla f(P)\\cdot \\mathbf{u} = (2,2)\\cdot(1/\\sqrt{2},1/\\sqrt{2}) = \\frac{2}{\\sqrt{2}}+\\frac{2}{\\sqrt{2}} = \\frac{4}{\\sqrt{2}}.\n$$\n\nPara calcular la derivada direccional en la dirección de un vector no unitario $\\mathbf{v}$, basta con convertirlo en unitario mediante la transformación\n\n$$\n\\mathbf{v'}=\\frac{\\mathbf{v}}{|\\mathbf{v}|}.\n$$\n:::\n\nComo se ha visto, para un vector unitario $\\mathbf{u}$\n\n$$\nf'_{\\mathbf{u}}(P) = \\nabla f(P)\\cdot \\mathbf{u} = |\\nabla f(P)|\\cos \\theta,\n$$\n\ndonde $\\theta$ es el ángulo que forma $\\mathbf{u}$ con el vector gradiente $\\nabla f(P)$.\n\nTeniendo en cuenta que $-1\\leq \\cos\\theta\\leq 1$, para cualquier vector $\\mathbf{u}$ se cumple\n\n$$\n-|\\nabla f(P)|\\leq f'_{\\mathbf{u}}(P)\\leq |\\nabla f(P)|.\n$$\n\nAdemás, si $\\mathbf{u}$ tiene la misma dirección y sentido que el gradiente, se tiene\n\n$$\nf'_{\\mathbf{u}}(P)=\\lvert \\nabla f(P)\\rvert \\cos 0=\\lvert \\nabla f(P)\\rvert.\n$$\n\nPor tanto, el crecimiento máximo de un campo escalar se produce en la dirección y sentido del gradiente.\n\nDel mismo modo, si $\\mathbf{u}$ tiene la misma dirección y sentido opuesto al gradiente, se tiene\n\n$$\nf'_{\\mathbf{u}}(P)=\\lvert \\nabla f(P)\\rvert \\cos \\pi=-\\lvert \\nabla f(P)\\rvert.\n$$\n\nPor tanto, el decrecimiento máximo de un campo escalar se produce en la dirección y sentido opuesto al gradiente.\n\n## Derivación implícita\n\nSi se sabe que la ecuación $$f(x,y)=0$$ define a $y$ como función de $x$, $y=h(x)$, alrededor de cierto valor $x=x_0$ para el que $y=h(x_0)=y_0$, entonces, si se toma la trayectoria $g(x)=(x,h(x))$, la ecuación anterior se puede expresar como\n\n$$\n(f\\circ g)(x) = f(g(x)) = f(x,h(x))=0,\n$$\n\nde modo que usando la regla de la cadena sobre se tiene\n\n$$\n(f\\circ g)'(x) = \\nabla f(g(x))\\cdot g'(x) = \\left(\\frac{\\partial f}{\\partial x}, \\frac{\\partial f}{\\partial y}\\right)\\cdot (1,h'(x)) =\n\\frac{\\partial f}{\\partial x}+\\frac{\\partial f}{\\partial y}h'(x) = 0,\n$$\n\nde donde se deduce\n\n$$\ny'=h'(x)=\\frac{-\\dfrac{\\partial f}{\\partial x}}{\\dfrac{\\partial f}{\\partial y}}\n$$\n\nA este proceso que permite obtener $y'$ en un entorno de $x_0$ sin disponer de la fórmula explícita $y=h(x)$, se le llama *derivación implícita*.\n\n:::{#exm-derivada-implicita}\nLa ecuación $x^2+y^2=1$ define a la circunferencia de radio 1 centrada en el origen de coordenadas, que también puede expresarse como\n\n$$\nf(x,y) = x^2+y^2-1 = 0.\n$$\n\nSi se piensa en $y$ como función implícita de $x$, se tiene\n\n$$\ny'=\\frac{-\\dfrac{\\partial f}{\\partial x}}{\\dfrac{\\partial f}{\\partial y}} = \\frac{-2x}{2y}=\\frac{-x}{y}.\n$$\n\nPodría llegarse al mismo resultado, despejando $y$ de la ecuación de la circunferencia,\n\n$$\nx^2+y^2=1 \\Leftrightarrow y^2=1-x^2 \\Leftrightarrow y= \\pm\\sqrt{1-x^2}.\n$$\n\nSi se toma la raíz positiva, que corresponde a la semicircunferencia superior, la derivada vale\n\n$$\ny' = \\frac{1}{2\\sqrt{1-x^2}}(-2x) = \\frac{-x}{\\sqrt{1-x^2}},\n$$\n\nque coincide con el resultado de la derivación implícita, teniendo en cuenta que $y=\\sqrt{1-x^2}$.\n:::\n\n### Propiedad del gradiente\n\n>**Teorema**. Sea $C$ el conjunto de nivel de un campo escalar $f$ que incluye a un punto $P$. Si $\\mathbf{v}$ es la velocidad al pasar por $P$ de una trayectoria que circule por $C$, entonces\n\n$$\n\\nabla f(P) \\cdot \\mathbf{v} = 0.\n$$\n\nEs decir, el vector gradiente de $f$ en $P$ es normal a $C$ en $P$, siempre que no sea nulo.\n\n**Demostración**. Si se considera una trayectoria $g(t)$ a lo largo del conjunto de nivel $C$ que pase por $P=g(t_0)$, de modo que $\\mathbf{v}=g'(t_0)$, entonces\n\n$$\n(f\\circ g)(t) = f(g(t)) = f(P),\n$$\n\nque es constante para cualquier $t$, y al aplicar la regla de la cadena se tiene\n\n$$\n(f\\circ g)'(t) = \\nabla f(g(t))\\cdot  g'(t) = 0,\n$$\n\nde modo que, cuanto $t=t_0$, se tiene\n\n$$\\nabla f(P)\\cdot \\mathbf{v} = 0.$$\n\n### Rectas normal y tangente a una linea en el plano\n\nSegún el resultado anterior, la recta normal a una línea $f(x,y)=0$ en un punto $P=(x_0,y_0)$, tiene ecuación\n\n$$P+t\\nabla f(P) = (x_0,y_0)+t\\nabla f(x_0,y_0).$$\n\n:::{#exm-tangente-normal-funcion-implicita-plano}\nDado el campo escalar $f(x,y)=x^2+y^2-1$, y el punto $P=(0,1)$, resulta que el conjunto de nivel que pasa por $P$, para el que $f(x,y)=f(P)=0$ es la circunferencia de radio 1 centrada en el origen. Así pues, tomando como vector normal el gradiente de $f$ $$\\nabla f(x,y) = (2x,2y),$$ que en el punto $P=(0,1)$ vale $\\nabla f(0,1) = (0,2)$, la recta normal a la circunferencia en $P$ es\n\n$$P+t\\nabla f(P) = (0,1)+t(0,2) = (0,1+2t),$$\n\nque se trata de la recta vertical $x=0$, que coincide con el eje $Y$.\n\ny la recta tangente a la circunferencia en $P$ es\n\n$$((x,y)-P)\\cdot \\nabla f(P) = ((x,y)-(0,1))\\cdot (0,2) = (x,y-1)\\cdot(0,2) = 2(y-1) = 0 \\Rightarrow y=1.$$\n:::\n\n### Recta normal y plano tangente a una superficie\n\nDe mismo modo, si en lugar de una línea en el plano se tiene una superficie $f(x,y,z)=0$, en el punto $P=(x_0,y_0,z_0)$ la recta normal tiene ecuación\n\n$$P+t\\nabla f(P) = (x_0,y_0,z_0)+t\\nabla f(x_0,y_0,z_0).$$\n\nDada el campo escalar $f(x,y,z)=x^2+y^2-z$, y el punto $P=(1,1,2)$, resulta que el conjunto de nivel que pasa por $P$, para el que $f(x,y)=f(P)=0$, es el paraboloide $z=x^2+y^2$. Así pues, tomando como vector normal el gradiente de $f$, que vale\n\n$$\\nabla f(x,y,z) = (2x,2y,-1),$$\n\nque en el punto $P=(1,1,2)$ vale $\\nabla f(1,1,2) = (2,2,-1)$, la recta normal al paraboloide en $P$ es\n\n$$P+t\\nabla f(P) = (1,1,2)+t\\nabla f(1,1,2) = (1,1,2)+t(2,2,-1) = (1+2t,1+2t,2-t),$$\n\nque se trata de la recta de ecuaciones $x=y$ y $x=5-2z$.\n\nY el plano tangente al paraboloide en $P$ es\n\n$$\n\\begin{aligned}\n((x,y,z)-P)\\cdot \\nabla f(P) &= ((x,y,z)-(1,1,2))(2,2,-1) = (x-1,y-1,z-2)(2,2,-1)=\\\\\n &= 2(x-1)+2(y-1)-(z-2) = 2x+2y-z-2= 0.\n\\end{aligned}\n$$\n\n<!-- :::{#exm-recta-tangente-plano-normal-superficie}\nLa gráfica del paraboloide $f(x,y,z)=x^2+y^2-z=0$ y su plano tangente en el punto $P=(1,1,2)$ es\n\n:::{.content-visible when-format=\"html\"}\n![Gráfica del plano tangente a un paraboloide](img/derivadas-funciones-varias-variables/plano_tangente_paraboloide.png)\n:::\n\n:::{.content-visible unless-format=\"html\"}\n![Gráfica del plano tangente a un paraboloide](img/derivadas-funciones-varias-variables/plano_tangente_paraboloide.pdf)\n::: -->\n:::\n\n## Derivadas de segundo orden\n\nLas derivadas parciales de una función son, a su vez, funciones de varias variables que muchas veces pueden volverse a derivar parcialmente con respecto a alguna de sus variables.\n\n:::{#def-derivadas-segundo-orden}\n## Derivadas parciales de segundo orden\nSi una función $f(x_1,\\ldots,x_n)$ tiene derivada parcial $$f'_{x_i}(x_1,\\ldots,x_n)$$ con respecto a la variable $x_i$ en un conjunto $A$, entonces podemos derivar de nuevo parcialmente $f'_{x_i}$ con respecto a la variable $x_j$. Esta segunda derivada, cuando existe, se llama *derivada parcial de segundo orden* de $f$ con respecto a las variables $x_i$ y $x_j$, y se nota\n\n$$\\frac{\\partial ^2 f}{\\partial x_j \\partial x_i}= \\frac{\\partial}{\\partial x_j}\\left(\\frac{\\partial f}{\\partial x_i}\\right).$$\n:::\n\nDe forma análoga se definen las derivadas de orden superior.\n\n:::{#exm-derivadas-segundo-orden}\nLa función de dos variables $$f(x,y)=x^y$$ tiene cuatro derivadas parciales de segundo orden, que son:\n\n$$\\begin{aligned}\n\\frac{\\partial^2 f}{\\partial x^2}(x,y) &=\n\\frac{\\partial}{\\partial x}\\left(\\frac{\\partial f}{\\partial x}(x,y)\\right) =\n\\frac{\\partial}{\\partial x}\\left(yx^{y-1}\\right) =\ny(y-1)x^{y-2},\\\\\n\\frac{\\partial^2 f}{\\partial y \\partial x}(x,y) &=\n\\frac{\\partial}{\\partial y}\\left(\\frac{\\partial f}{\\partial x}(x,y)\\right) =\n\\frac{\\partial}{\\partial y}\\left(yx^{y-1}\\right) =\nx^{y-1}+yx^{y-1}\\log x,\\\\\n\\frac{\\partial^2 f}{\\partial x \\partial y}(x,y) &=\n\\frac{\\partial}{\\partial x}\\left(\\frac{\\partial f}{\\partial y}(x,y)\\right) =\n\\frac{\\partial}{\\partial x}\\left(x^y\\log x \\right) =\nyx^{y-1}\\log x+x^y\\frac{1}{x},\\\\\n\\frac{\\partial^2 f}{\\partial y^2}(x,y) &=\n\\frac{\\partial}{\\partial y}\\left(\\frac{\\partial f}{\\partial y}(x,y)\\right) =\n\\frac{\\partial}{\\partial y}\\left(x^y\\log x \\right) =\nx^y(\\log x)^2.\\end{aligned}$$\n:::\n\n## Matriz hessiana\n\n:::{#def-matriz-hessiana}\n## Matriz hessiana\nDada una función de $n$ variables $f(x_1,\\ldots,x_n)$, para la que existen todas sus derivadas parciales de segundo orden en un punto $a=(a_1,\\ldots,a_n)$, se define la *matriz hessiana* de $f$ en $a$, y se nota $\\nabla^2f(a)$, como la matriz cuadrada cuyos elementos son\n\n$$\\nabla^2f(a)=\\left(\n\\begin{array}{cccc}\n\\dfrac{\\partial^2 f}{\\partial x_1^2}(a) &\n\\dfrac{\\partial^2 f}{\\partial x_1 \\partial x_2}(a) &\n\\cdots &\n\\dfrac{\\partial^2 f}{\\partial x_1 \\partial x_n}(a)\\\\\n\\dfrac{\\partial^2 f}{\\partial x_2 \\partial x_1}(a) &\n\\dfrac{\\partial^2 f}{\\partial x_2^2}(a) &\n\\cdots &\n\\dfrac{\\partial^2 f}{\\partial x_2 \\partial x_n}(a)\\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\n\\dfrac{\\partial^2 f}{\\partial x_n \\partial x_1}(a) &\n\\dfrac{\\partial^2 f}{\\partial x_n \\partial x_2}(a) &\n\\cdots &\n\\dfrac{\\partial^2 f}{\\partial x_n^2}(a)\n\\end{array}\n\\right).$$\n\nAl determinante de esta matriz se le llama *hessiano* de $f$ en $a$, y se nota $Hf(a)=\\lvert \\nabla^2f(a)\\rvert$.\n:::\n\n:::{#exm-matriz-hessiana}\nConsideremos de nuevo la función de dos variables $f(x,y)=x^y$. Su matriz hessiana es\n\n$$\\nabla^2f(x,y)=\\left(\n\\begin{array}{cc}\n\\dfrac{\\partial^2 f}{\\partial x^2} & \\dfrac{\\partial^2 f}{\\partial x \\partial y}\\\\\n\\dfrac{\\partial^2 f}{\\partial y \\partial x} & \\dfrac{\\partial^2 f}{\\partial y^2}\n\\end{array}\n\\right)\n=\n\\left(\n\\begin{array}{cc}\ny(y-1)x^{y-2} & x^{y-1}(y\\log x+1) \\\\\nx^{y-1}(y\\log x+1) & x^y(\\log x)^2\n\\end{array}\n\\right).$$\n\nEn el punto $(1,2)$ la matriz vale\n\n$$\\nabla^2f(1,2)=\\left(\n\\begin{array}{cc}\n2(2-1)1^{2-2} & 1^{2-1}(2\\log 1+1) \\\\\n1^{2-1}(2\\log 1+1) & 1^2(\\log 1)^2\n\\end{array}\n\\right)\n=\n\\left(\n\\begin{array}{cc}\n2 & 1 \\\\\n1 & 0\n\\end{array}\n\\right).$$\n\nY el hessiano en dicho punto vale\n\n$$Hf(1,2)=\\left|\n\\begin{array}{cc}\n2 & 1 \\\\\n1 & 0\n\\end{array}\n\\right|=\n2\\cdot 0-1\\cdot1= -1.\n$$\n:::\n\n### Igualdad de las derivadas cruzadas\n\nEn el ejemplo anterior se aprecia que las *derivadas cruzadas* de segundo orden $\\frac{\\partial^2 f}{\\partial y\\partial x}$ y $\\frac{\\partial^2 f}{\\partial x\\partial y}$ coinciden. Ello es debido al siguiente teorema:\n\n>**Teorema - Igualdad derivadas cruzadas**. Si $f(x,y)$ es una función tal que sus derivadas parciales $\\frac{\\partial f}{\\partial x}$, $\\frac{\\partial f}{\\partial y}$, $\\frac{\\partial^2 f}{\\partial y\\partial x}$ y $\\frac{\\partial^2 f}{\\partial x\\partial y}$ existen y son continuas en un conjunto abierto $A$, entonces\n\n$$\\frac{\\partial^2 f}{\\partial y\\partial x}=\\frac{\\partial^2 f}{\\partial x\\partial y}.$$\n\nUna consecuencia del teorema es que, al calcular una derivada parcial de segundo orden que cumpla lo anterior, *¡el orden en que se realicen las derivadas parciales no importa!*\n\nSi el teorema se cumple para todas las derivadas parciales de segundo orden, entonces la matriz hessiana es simétrica.\n\n## Fórmula de Taylor\n\n### Aproximación lineal de un campo escalar\n\nYa se vio cómo aproximar funciones de una variable mediante polinomios de Taylor. Esto también se puede generalizar a la aproximación de campos escalares mediante polinomios de varias variables.\n\nSi $P$ es un punto del dominio de un campo escalar $f$ y $\\mathbf{v}$ un vector, la *fórmula de Taylor* de primer grado de $f$ alrededor del\npunto $P$ es\n\n$$f(P+\\mathbf{v}) = f(P) + \\nabla f(P)\\cdot \\mathbf{v} +R^1_{f,P}(\\mathbf{v}),$$\n\ndonde\n\n$$\n\\begin{aligned}\nP^1_{f,P}(\\mathbf{v}) = f(P)+\\nabla f(P)\\mathbf{v}\n\\end{aligned}\n$$\n\nes el *polinomio de Taylor* de primer grado de $f$ en el punto $P$, y $R^1_{f,P}(\\mathbf{v})$ es el *resto de taylor* para el vector $\\mathbf{v}$, y mide el error cometido en la aproximación.\n\nSe cumple que\n\n$$\\lim_{|\\mathbf{v}|\\rightarrow 0} \\frac{R^1_{f,P}(\\mathbf{v})}{|\\mathbf{v}|} = 0$$\n\nObsérvese que el polinomio de Taylor de primer grado coincide con el plano tangente a $f$ en $P$.\n\nSi $f$ es un campo escalar de dos variables $f(x,y)$ y $P=(x_0,y_0)$, teniendo en cuenta que para un punto cualquiera $Q=(x,y)$, el vector $\\mathbf{v}=\\vec{PQ}=(x-x_0,y-y_0)$, el polinomio de Taylor de $f$ en el punto $P$, puede expresarse\n\n$$\\begin{aligned}\nP^1_{f,P}(x,y) &= f(x_0,y_0)+\\nabla f(x_0,y_0)(x-x_0,y-y_0) =\\\\\n&= f(x_0,y_0)+\\frac{\\partial f}{\\partial x}(x_0,y_0)(x-x_0)+\\frac{\\partial f}{\\partial y}(x_0,y_0)(y-y_0).\n\\end{aligned}\n$$\n\n:::{#exm-}\nDado el campo escalar $f(x,y)=\\log(xy)$, su gradiente es\n\n$$\\nabla f(x,y) = \\left(\\frac{1}{x},\\frac{1}{y}\\right),$$\n\ny el polinomio de Taylor de primer grado en el punto $P=(1,1)$ es\n\n$$\n\\begin{aligned}\nP^1_{f,P}(x,y) &= f(1,1) +\\nabla f(1,1)\\cdot (x-1,y-1) = \\\\\n&= \\log 1+(1,1)\\cdot(x-1,y-1) = x-1+y-1 = x+y-2.\\\\\n\\end{aligned}\n$$\n\nEste polinomio, permite aproximar el valor de $f$ cerca del punto $P$.\n\nPor ejemplo\n\n$$f(1.01,1.01) \\approx P^1_{f,P}(1.01,1.01) = 1.01+1.01-2 = 0.02.$$\n\n### Aproximación cuadrática de un campo escalar\n\nSi $P$ es un punto del dominio de un campo escalar $f$ y $\\mathbf{v}$ un vector, la *fórmula de Taylor* de segundo grado de $f$ alrededor del punto $P$ es\n\n$$f(P+\\mathbf{v}) = f(P) + \\nabla f(P)\\cdot \\mathbf{v} + \\frac{1}{2}\\nabla^2f(P)\\mathbf{v}\\cdot\\mathbf{v} + R^2_{f,P}(\\mathbf{v}),$$\n\ndonde\n\n$$\n\\begin{aligned}\nP^2_{f,P}(\\mathbf{v})&=f(P)+\\nabla f(P)\\mathbf{v}+\\frac{1}{2}\\nabla^2f(P)\\mathbf{v}\\cdot\\mathbf{v}\n\\end{aligned}\n$$\n\nes el *polinomio de Taylor* de segundo grado de $f$ en el punto $P$, y $R^2_{f,P}(\\mathbf{v})$ es el *resto de taylor* para el vector $\\mathbf{v}$.\n\nSe cumple que\n\n$$\\lim_{|\\mathbf{v}\\rightarrow 0|} \\frac{R^2_{f,P}(\\mathbf{v})}{|\\mathbf{v}|^2} = 0$$\n\nlo que indica que el resto es mucho más pequeño que el cuadrado del módulo de $\\mathbf{v}$.\n\nSi $f$ es un campo escalar de dos variables $f(x,y)$ y $P=(x_0,y_0)$, el polinomio de Taylor de $f$ en el punto $P$, puede expresarse\n\n$$\n\\begin{gathered}\nP^2_{f,P}(x,y) = f(x_0,y_0)+\\nabla f(x_0,y_0)(x-x_0,y-y_0) +\\\\\n+\\frac{1}{2}(x-x_0,y-y_0)\\nabla^2f(x_0,y_0)(x-x_0,y-y_0)= \\\\\n= f(x_0,y_0)+\\frac{\\partial f}{\\partial x}(x_0,y_0)(x-x_0)+\\frac{\\partial f}{\\partial y}(x_0,y_0)(y-y_0)+\\\\\n+\\frac{1}{2}\\left(\\frac{\\partial^2 f}{\\partial x^2}(x_0,y_0) (x-x_0)^2 + 2\\frac{\\partial^2 f}{\\partial y\\partial x}(x_0,y_0) (x-x_0)(y-y_0) + \\frac{\\partial^2 f}{\\partial y^2}(x_0,y_0) (y-y_0)^2\\right)\n\\end{gathered}\n$$\n\n:::{#exm-polinomio-taylor-funcion-varias-variables}\nDado el campo escalar $f(x,y)=\\log(xy)$, su gradiente es\n\n$$\\nabla f(x,y) = \\left(\\frac{1}{x},\\frac{1}{y}\\right),$$\n\ny su matriz hessiana es\n\n$$Hf(x,y) = \\left(\n\\begin{array}{cc}\n\\frac{-1}{x^2} & 0\\\\\n0 & \\frac{-1}{y^2}\n\\end{array}\n\\right)$$\n\ny el polinomio de Taylor de segundo grado en el punto $P=(1,1)$ es\n\n$$\n\\begin{aligned}\nP^2_{f,P}(x,y) &= f(1,1) +\\nabla f(1,1)\\cdot (x-1,y-1) + \\frac{1}{2}(x-1,y-1)\\nabla^2f(1,1)\\cdot(x-1,y-1)=\\\\\n&= \\log 1+(1,1)\\cdot(x-1,y-1) + \\frac{1}{2}(x-1,y-1)\n\\left(\n\\begin{array}{cc}\n-1 & 0\\\\\n0 & -1\n\\end{array}\n\\right)\n\\left(\n\\begin{array}{c}\nx-1\\\\\ny-1\n\\end{array}\n\\right)\n= \\\\\n&= x-1+y-1+\\frac{-x^2-y^2+2x+2y-2}{2} = \\frac{-x^2-y^2+4x+4y-6}{2}.\n\\end{aligned}\n$$\n\nAsí, $$f(1.01,1.01) \\approx P^1_{f,P}(1.01,1.01) = \\frac{-1.01^2-1.01^2+4\\cdot 1.01+4\\cdot 1.01-6}{2} = 0.0199$$.\n:::\n\n## Extremos\n\n:::{#def-extremos-relativos}\n## Máximo y mínimo relativos\nDado un campo escalar $f$ de $\\mathbb{R}^n$, se dice que un punto $P$ es un *máximo relativo* de $f$ si existe un valor $\\epsilon>0$ tal que\n\n$$f(P)\\geq f(X)\\ \\forall X, |\\vec{PX}|<\\epsilon.$$\n\nDel mismo modo se dice que un punto $P$ es un *mínimo relativo* de $f$ si existe un valor $\\epsilon>0$ tal que\n\n$$f(P)\\leq f(X)\\ \\forall X, |\\vec{PX}|<\\epsilon.$$\n\nA los máximos y mínimos de $f$ se les conoce como *extremos relativos* de $f$.\n:::\n\n### Anulación del gradiente en los extremos\n\nSi $P$ es un extremo de un campo escalar $f$ de $\\mathbb{R}^n$, entonces $P$ es un punto crítico de $f$, es decir,\n\n$$\\nabla f(P) = 0.$$\n\nTomando la trayectoria que pasa por $P$ con la dirección y sentido del gradiente, $$g(t)=P+t\\nabla f(P),$$ la función $h=(f\\circ g)(t)$ nunca decrece ya que\n\n$$h'(t)= (f\\circ g)'(t) = \\nabla f(g(t))\\cdot g'(t) = \\nabla f(P)\\cdot \\nabla f(P) = |\\nabla f(P)|^2\\geq 0.$$\n\ny sólo se anula si $\\nabla f(P)=0$.\n\nAsí pues, si $\\nabla f(P)\\neq 0$, entonces $P$ no puede ser un máximo ya que siguiendo la trayectoria de $g$ desde $P$ se encontrarían puntos en los que la imagen de $f$ es mayor que en $P$. Del mismo modo, siguiendo la trayectoria opuesta a $g$ se encontrarían puntos en los que la imagen de $f$ es menor que la imagen en $P$, por lo que tampoco puede ser un mínimo.\n\n:::{#exm-extremos-relativos}\nPara el campo escalar $f(x,y)=x^2+y^2$, resulta evidente que sólo tiene un mínimo en el origen $(0,0)$ ya que\n\n$$f(0,0)=0 \\leq f(x,y)=x^2+y^2,\\ \\forall x,y\\in \\mathbb{R}.$$\n\nEn este punto se cumple, $\\nabla f(0,0) = 0$.\n\n<!-- :::{.content-visible when-format=\"html\"}\n![Gráfica del mínimo relativo de un paraboloide](img/derivadas-funciones-varias-variables/minimo_paraboloide.png)\n:::\n\n:::{.content-visible unless-format=\"html\"}\n![Gráfica del mínimo relativo de un paraboloide](img/derivadas-funciones-varias-variables/minimo_paraboloide.pdf)\n::: -->\n:::\n\n### Puntos de silla\n\nNo todos los puntos críticos son extremos. Si se considera, por ejemplo, el campo escalar $f(x,y)=x^2-y^2$, su gradiente es\n\n$$\\nabla f(x,y) = (2x,-2y),$$\n\nque sólo se anula en el punto $(0,0)$. Sin embargo, este punto no es un máximo relativo ya que los puntos $(x,0)$ del eje $X$ tienen imágenes $f(x,0)=x^2\\geq 0=f(0,0)$, y tampoco es un mínimo relativo ya que los puntos $(0,y)$ del eje $Y$ tienen imágenes $f(0,y)=-y^2\\leq 0=f(0,0)$. Este tipo de puntos que anulan el gradiente pero que no son extremos, se conocen como *puntos de silla*.\n\n<!-- :::{.content-visible when-format=\"html\"}\n![Gráfica de un punto de silla](img/derivadas-funciones-varias-variables/punto_silla.png)\n:::\n\n:::{.content-visible unless-format=\"html\"}\n![Gráfica de un punto de silla](img/derivadas-funciones-varias-variables/punto_silla.pdf)\n::: -->\n\n### Determinación de los extremos de un campo escalar\n\nDe la fórmula de Taylor de segundo grado para un campo escalar $f$ en un punto $P$ se deduce que\n\n$$f(P+\\mathbf{v})-f(P)\\approx \\nabla f(P)\\mathbf{v}+\\frac{1}{2}\\nabla^2f(P)\\mathbf{v}\\cdot\\mathbf{v}.$$\n\nDe manera que si $P$ es un punto crítico de $f$, como $\\nabla f(P)=0$, se tiene que\n\n$$f(P+\\mathbf{v})-f(P)\\approx \\frac{1}{2}\\nabla^2f(P)\\mathbf{v}\\cdot\\mathbf{v}.$$\n\nPor tanto, el signo de $f(P+\\mathbf{v})-f(P)$ coincide con el signo del término cuadrático $Hf(P)\\mathbf{v}\\cdot\\mathbf{v}$.\n\nSe pueden dar cuatro posibilidades:\n\n- Definido positivo: $\\nabla^2f(P)\\mathbf{v}\\cdot\\mathbf{v}>0$ $\\forall \\mathbf{v}\\neq 0$.\n- Definido negativo: $\\nabla^2f(P)\\mathbf{v}\\cdot\\mathbf{v}<0$ $\\forall \\mathbf{v}\\neq 0$.\n- Indefinido: $\\nabla^2f(P)\\mathbf{v}\\cdot\\mathbf{v}>0$ para algún $\\mathbf{v}\\neq 0$ y $\\nabla^2f(P)\\mathbf{u}\\cdot\\mathbf{u}<0$ para algún $\\mathbf{u}\\neq 0$.\n- Semidefinido: Cualquier otro caso distinto de los anteriores.\n\nAsí pues, dependiendo el signo de $Hf(P)\\mathbf{v}\\cdot\\mathbf{v}$, se tiene\n\n>**Teorema**. Dado un punto crítico $P$ de un campo escalar $f$ que tiene matríz hessiana $Hf(P)$, se cumple\n\n- Si $\\nabla^2f(P)$ es definido positivo entonces $f$ tiene un *mínimo relativo* en $P$.\n- Si $\\nabla^2f(P)$ es definido negativo entonces $f$ tiene un *máximo relativo* en $P$.\n- Si $\\nabla^2f(P)$ es indefinido entonces $f$ tiene un *punto de silla* en $P$.\n\nEn el caso de que $\\nabla^2f(P)$ sea semidefinido, no se puede obtener ninguna conclusión y hay que recurrir a derivadas parciales de orden superior.\n\nEn el caso particular de un campo escalar de dos variables se tiene\n\n>**Teorema**. Dado un punto crítico $P=(x_0,y_0)$ de un campo escalar $f(x,y)$ que tiene matríz hessiana $\\nabla^2f(P)$, se cumple\n\n- Si $Hf(P)>0$ y $\\frac{\\partial^2 f}{\\partial x^2}(x_0,y_0)>0$ entonces $f$ tiene un *mínimo relativo* en $P$.\n- Si $Hf(P)>0$ y $\\frac{\\partial^2 f}{\\partial x^2}(x_0,y_0)<0$ entonces $f$ tiene un *máximo relativo* en $P$.\n- Si $Hf(P)<0$ entonces $f$ tiene un *punto de silla* en $P$.\n\n:::{#exm-extremos-relativos-2}\nDada el campo escalar $f(x,y)=\\dfrac{x^3}{3}-\\dfrac{y^3}{3}-x+y$, se tiene que su gradiente vale\n\n$$\\nabla f(x,y)= (x^2-1,-y^2+1),$$\n\nque se anula en los puntos $(1,1)$, $(1,-1)$, $(-1,1)$ y $(-1,-1)$.\n\nLa matriz hessiana vale\n\n$$\\nabla^2f(x,y) = \\left(\n\\begin{array}{cc}\n2x & 0\\\\\n0 & -2y\n\\end{array}\n\\right)$$\n\ny el hessiano vale\n\n$$Hf(x,y) = -4xy.$$\n\nAsí pues, se tiene\n\n- Punto $(1,1)$: $Hf(1,1)=-4<0 \\Rightarrow$ Punto de silla.\n- Punto $(1,-1)$: $Hf(1,-1)=4>0$ y $\\frac{\\partial^2}{\\partial x^2}(1,-1)=2>0 \\Rightarrow$ Mínimo relativo.\n- Punto $(-1,1)$: $Hf(-1,1)=4>0$ y $\\frac{\\partial^2}{\\partial x^2}(-1,1)=-2<0 \\Rightarrow$ Máximo relativo.\n- Punto $(-1,-1)$: $Hf(-1,-1)=-4<0 \\Rightarrow$ Punto de silla.\n\n<!-- :::{.content-visible when-format=\"html\"}\n![Gráfica de los extremos relativos y los puntos de silla de una función](img/derivadas-funciones-varias-variables/determinacion_extremos.png)\n:::\n\n:::{.content-visible unless-format=\"html\"}\n![Gráfica de los extremos relativos y los puntos de silla de una función](img/derivadas-funciones-varias-variables/determinacion_extremos.pdf)\n::: -->\n:::\n\n",
    "supporting": [
      "13-derivadas-funciones-varias-variables_files/figure-pdf"
    ],
    "filters": []
  }
}