% Thanks to http://tex.stackexchange.com/a/30782/5645 for this
% example!
\documentclass{article}
\usepackage{amsmath}
\usepackage{ amssymb}
\usepackage{mathptmx}
\usepackage{tikz}
\usepackage{pgfplots}
\usepgfplotslibrary{polar}
\usepgfplotslibrary{fillbetween}
\usepackage{tkz-fct}
\usetikzlibrary{angles, quotes}
\usetikzlibrary{arrows.meta, arrows}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{external}
\tikzexternalize[prefix={external/}]

\tikzset{
    export as png/.style={
        external/system call/.add={}{
            && convert -density #1 -transparent white "\image.pdf" "\image.png"
        },
    },
    export as png/.default={200},
    % Arrow tips
    >=stealth,
}

% pgfplots settings
\input{colors}
\input{pgfplots}

\DeclareSymbolFont{symbolsb}{OMS}{cmsy}{m}{n}
\SetSymbolFont{symbolsb}{bold}{OMS}{cmsy}{b}{n}
\DeclareSymbolFontAlphabet{\mathcal}{symbolsb}

\def\req{\protect\rotatebox{90}{$\scriptstyle=$}}

\newcommand{\addaxes}{\draw (0em,1em) -- (0em,-1em)
                            (-1em,0em) -- (1em,0em);}
\newcommand{\stepfunc}{\draw[line width=1.5pt] (0.65em,0.65em) -- (0,0.65em) 
                                    -- (0,-0.65em) -- (-0.65em,-0.65em);}

\begin{document}

\tikzset{export as png}

\tikzsetnextfilename{integral-cota-superior-serie}

% Author: Alfredo SÃ¡nchez Alberca (asalber@ceu.es)
\begin{tikzpicture}
    \begin{axis}[
        axis lines=middle,
        enlargelimits=true,
        %grid=major,
        xlabel=$x$,
        ylabel=$y$,
        xmin=0, xmax=7,
        ymin=0, ymax=1.2,
        xtick={1,2,3,4,5,6},
        ytick=\empty,
        yticklabels={},
        clip=false,
        %axis on top,
        domain=1:7,
        samples=100,
        %xlabel near ticks,
        %ylabel near ticks
        myblack
    ]
        % Plot the function 1/x
        \addplot[myblue, thick] {1/x} node[pos=0.85, anchor=south west] {$y=f(x)$};
    
        % Add Riemann rectangles
        \addplot[ybar interval, mark=no, fill=myblue, opacity=0.5] plot coordinates {
            (1, 1/2)
            (2, 1/3)
            (3, 1/4)
            (4, 1/5)
            (5, 1/6)
            (6, 1/7)
            (6, 0)  % This is to complete the last rectangle
        };
        \node at (axis cs:1.5,0.1) {$a_2$};
        \node at (axis cs:2.5,0.1) {$a_3$};
        \node at (axis cs:3.5,0.1) {$a_4$};
        \node at (axis cs:4.5,0.1) {$a_5$};
        \node at (axis cs:5.5,0.1) {$a_6$};
        \node at (axis cs:6.5,0.1) {$\cdots$};
        \node[myblue] at (axis cs:4.5,0.7) {$\displaystyle \sum_{n=2}^\infty a_n$};
    
    \end{axis}
    \end{tikzpicture}

\end{document}