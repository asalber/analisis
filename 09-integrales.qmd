---
title: Integrales de funciones
crossref:
    chapters: true
lang: es
---

::: {.content-visible unless-format="pdf"}
{{< include macros.qmd >}}
:::

En este capítulo se estudian las _integrales_ de números reales, que junto a las derivadas son las dos ramas del Análisis más importantes. Veremos también el _teorema fundamental del cálculo_, uno de los resultados más importantes del Análisis que relaciona el cálculo diferencial con el integral, al cuál llegaron de manera simultanea Newton y Leibniz.

Históricamente el concepto de integral surge a partir del estudio de áreas, inicialmente de figuras geométricas, y después, de figuras curvas. En la antigua Grecia ya se utilizaba el _[método por agotamiento](https://es.wikipedia.org/wiki/M%C3%A9todo_por_agotamiento)_ para calcular áreas de figuras no geométricas, y Arquímedes fue capaz de aproximar el área encerrada por una circunferencia usando este método.

Para llegar a la definición de integral explotaremos este método aproximando el area bajo una función usando rectángulos. El precursor de esta idea fue [Bernhard Riemann](https://es.wikipedia.org/wiki/Bernhard_Riemann).

## Sumas de Riemann

:::{#def-particion-intervalo}
## Partición de un intervalo
Dado un intervalo $I=[a,b]$ cerrado y acotado en $\mathbb{R}$, una _partición_ de $I$ es un conjunto ordenado y finito $P=\{x_0, x_1, \ldots, x_n\}$ de puntos de $I$ tales que $a=x_0<x_1<x_2<\cdots<x_n=b$.

El conjunto de todas las particiones de un intervalo $I$ se denota $\mathcal{P}(I)$.
:::

:::{#def-suma-inferior-riemann}
## Suma inferior de Riemann
Dada una función $f: I\to\mathbb{R}$ acotada en el intervalo $I=[a,b]$ y una partición $P=\{x_0, x_1, \ldots, x_n\}$ de $I$, se define la _suma inferior_ de $f$ respecto de $P$, y se denota $s(f,P)$, como

$$
s(f,P) = \sum_{i=1}^n m_i(x_i-x_{i-1})
$$

donde $m_i=\inf\{f(x): x\in[x_{i-1},x_i]\}$ para $i=1,\ldots,n$.
:::

Gráficamente, si $f$ es una función positiva, la suma inferior se puede interpretar como la suma de las areas de los rectángulos con base $[x_{i-1},x_i]$ y altura $m_i$.

:::{.content-visible when-format="html"}
![Suma inferior de Riemann](img/integrales/suma-inferior-riemann.png)
:::

:::{.content-visible unless-format="html"}
![Suma inferior de Riemann](img/integrales/suma-inferior-riemann.pdf)
:::

:::{#def-suma-superior-riemann}
## Suma superior de Riemann
Dada una función $f: I\to\mathbb{R}$ acotada en el intervalo $I=[a,b]$ y una partición $P=\{x_0, x_1, \ldots, x_n\}$ de $I$, se define la _suma superior_ de $f$ respecto de $P$, y se denota $S(f,P)$, como

$$
S(f,P) = \sum_{i=1}^n M_i(x_i-x_{i-1})
$$

donde $M_i=\sup\{f(x): x\in[x_{i-1},x_i]\}$ para $i=1,\ldots,n$.
:::

Gráficamente, si $f$ es una función positiva, la suma superior se puede interpretar como la suma de las areas de los rectángulos con base $[x_{i-1},x_i]$ y altura $M_i$.

:::{.content-visible when-format="html"}
![Suma superior de Riemann](img/integrales/suma-superior-riemann.png)
:::

:::{.content-visible unless-format="html"}
![Suma inferior de Riemann](img/integrales/suma-superior-riemann.pdf)
:::

:::{.callout-warning}
Obsérvese que si una función es negativa en un intervalo $I$, sus sumas de Riemann son negativas, ya que las alturas de los rectángulos son negativas.

:::{.content-visible when-format="html"}
![Sumas de Riemann de una función con valores positivos y negativos en un intervalo.](img/integrales/sumas-riemann-positivas-negativas.png)
:::

:::{.content-visible unless-format="html"}
![Sumas de Riemann de una función con valores positivos y negativos en un intervalo.](img/integrales/sumas-riemann-positivas-negativas.pdf)
:::
:::

::: {.content-visible when-format="html"}
<div id="ggb-suma-riemann-1"></div>

<script>
var params = {
            "appName": "classic", 
            "width": 800, 
            "height": 500, 
            "showToolBar": false, 
            "showAlgebraInput": false, 
            "showMenuBar": false,
            "borderColor": "#FFFFFF",
            "enableRightClick": false,
            "enableLabelDrags": false,
            "enableShiftDragZoom": false,
            "showZoomButtons": false,
            "showResetIcon": true,
            //"showFullscreenButton": true,
            "transparentGraphics": true,
            "material_id":"m9bz6w25"
            };
    var ggbApplet1 = new GGBApplet(params, true);
    window.addEventListener("load", function() { 
        ggbApplet1.inject('ggb-suma-riemann-1');
    });
</script>
:::

[![Calculadora de sumas de Riemann](/img/logos/logo-geogebra.png) Calculadora de sumas de Riemann](https://www.geogebra.org/classic/nr6x8pjq)

:::{#prp-sumas-riemann-inferior-superior}
Si $f:I\to\mathbb{R}$ es una función acotada en el intervalo $I=[a,b]$ y $P=\{x_0, x_1, \cdots, x_n\}$ es una partición de $I$, entonces $s(f,P)\leq S(f,P)$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Para cada $i=1,\ldots,n$ se tiene que 

$$
m_i=\inf\{f(x): x\in[x_{i-1},x_i]\}\leq \sup\{f(x): x\in[x_{i-1},x_i]\} = M_i,
$$

de manera que

$$
s(f,P) = \sum_{i=1}^n m_i(x_i-x_{i-1}) \leq \sum_{i=1}^n M_i(x_i-x_{i-1}) = S(f,P),
$$

ya que $(x_i-x_{i-1})>0$ $\forall i=1,\ldots,n$.
:::
:::

:::{#def-refinamiento-particion}
## Refinamiento de una partición
Dadas dos particiones $P=\{x_0, x_1, \ldots, x_n\}$ y $Q=\{y_0, y_1, \ldots, y_m\}$ de un intervalo $I=[a,b]$, se dice que $Q$ es un refinamiento de $P$ si todos los puntos de $P$ están en $Q$, es decir, $P\subseteq Q$.
:::

:::{#prp-sumas-riemann-refinamiento}
Si $f:I\to\mathbb{R}$ es una función acotada en el intervalo $I=[a,b]$, $P$ es una partición de $I$ y $Q$ es un refinamiento de $P$, entonces

a. $s(f,P)\leq S(f,Q)$
b. $s(f,Q)\leq S(f,P)$
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Veremos solo la prueba para las sumas inferiores.

a. Probaremos primero el resultado para un refinamiento con un punto más. Sea $P=\{x_0, x_1, \cdots, x_n\}$ y supongamos que $Q$ solo tiene un punto $c$ más que $P$. Sea $k\in\{1,\ldots,n\}$ tal que $c\in[x_{k-1},x_k]$ y tomemos $m_k'=\inf\{f(x): x\in[x_{k-1},c]\}$ y $m_k''=\inf\{f(x): x\in[c,x_k]\}$. Como $m_k=\inf\{f(x): x\in[x_{k-1},x_k]\}$ resulta evidente que $m_k\leq m_k'$ y $m_k\leq m_k''$, por lo que 

    $$
    m_k(x_k-x_{k-1}) = m_k(x_k-c)+m_k(c-x_{k-1})\leq m_k''(x_k-c)+m_k'(c-x_{k-1})
    $$

    y entonces

    \begin{align*}
    s(f,P) &= \sum_{i=1}^n m_i(x_i-x_{i-1}) = \sum_{i=1,i\neq k}^n m_i(x_i-x_{i-1}) + m_k(x_k-x_{k-1}) \\ &\leq \sum_{i=1,i\neq k}^n m_i(x_i-x_{i-1}) + m_k''(x_k-c) + m_k'(c-x_{k-1}) = s(f,Q).
    \end{align*}
    
    Para probar el caso general, si $Q$ es un refinamiento cualquiera de $P$, entonces existe una sucesión finita de particiones de $I$, $P_1,P_2,\ldots,P_r$ tales que  $P=P_1\subset P_2\subset\cdots \subset P_r=Q$ y cada $P_i$ tiene solo un punto más que $P_{i-1}$. Así pues, por el resultado anterior, 

    $$
    s(f,P)\leq s(f,P_2)\leq \cdots \leq s(f,Q).
    $$

b. La prueba para las sumas superiores es análoga y se deja como ejercicio.
:::
:::

:::{#prp-sumas-riemann-particiones}
Si $f:I\to\mathbb{R}$ es una función acotada en el intervalo $I=[a,b]$ y $P$ y $Q$ son dos particiones de $I$, entonces $s(f,P)\leq S(f,Q)$ y $s(f,Q)\leq S(f,P)$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Tomando la partición de $I$ $P'=P\cup Q$, se tiene que $P'$ es un refinamiento de $P$ y $Q$, de manera que, según las proposiciones anteriores se tiene 

$$
s(f,P)\leq s(f,P')\leq S(f,P')\leq S(f,Q)
$$

y

$$
s(f,Q)\leq s(f,P')\leq S(f,P')\leq S(f,P).
$$
:::
:::

## Integrales de Riemann

Como acabamos de ver, dada una función $f$ positiva en un intervalo $I$, para cualquier partición $P$ de $I$, la suma inferior de Riemann es una aproximación por defecto del área encerrada entre la gráfica de $f$ y el eje $x$ en el intervalo $I$, mientras que la suma superior de Riemann es una aproximación por exceso. Si al hacer refinamientos de la partición $P$, cada vez con un mayor número de subintervalos, las sumas inferiores crecen y las superiores decrecen, se obtienen aproximaciones cada vez mejores. Podemos explotar esta idea para calcular el area área encerrada entre la gráfica de $f$ y el eje $x$ tomando particiones con subintervalos cada vez más pequeños.

:::{.content-visible when-format="html"}
![Aproximación del area encerrada entre la gráfica de una función y el eje $x$ mediante sumas de Riemann.](img/integrales/sumas_riemann.gif)
:::

:::{#def-integral-inferior-riemann}
## Integral inferior de Riemann
Dada una función $f:I\to\mathbb{R}$ acotada en el intervalo $I=[a,b]$, se define la _integral inferior_ de $f$ en $I$ como el número $\underline{\int_a^b} f =\inf\{s(f,P): P\in \mathcal{P}(I)\}$.
:::

:::{#def-integral-superior-riemann}
## Integral superior de Riemann
Dada una función $f:I\to\mathbb{R}$ acotada en el intervalo $I=[a,b]$, se define la _integral superior_ de $f$ en $I$ como el número $\overline{\int_a^b} f =\inf\{S(f,P): P\in \mathcal{P}(I)\}$.
:::

:::{#prp-integral-riemann-inferior-superior}
Si $f:I\to\mathbb{R}$ es una función acotada en el intervalo $I=[a,b]$, entonces $\underline{\int_a^b} f\leq \overline{\int_a^b}f$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Sean $P$ y $Q$ dos particiones cualesquiera de $I$. Por la proposición anterior, $s(f,P)\leq S(f,Q)$ $\forall P\in\mathcal(P)(I)$, de modo que $S(f,Q)$ es una cota superior de todas las sumas inferiores, y por tanto,

$$
\underline{\int_a^b} f =  \sup\{s(f,P): P\in\mathcal{P}(I)\}\leq S(f,Q)
$$

Como esto es cierto para cualquier partición $Q$, se tiene que $\underline{\int_a^b} f$ es una cota inferior de todas las sumas superiores, y por tanto,

$$
\underline{\int_a^b} f \leq \inf\{S(f,Q): Q\in\mathcal{P}(I)\} = \overline{\int_a^b}f.
$$
:::
::: 

:::{#def-integral-riemann}
Dada una función $f:I\to\mathbb{R}$ acotada en el intervalo $I=[a,b]$, se dice que $f$ es _integrable Riemann_ en $I$ si 

$$
\underline{\int_a^b} f = \overline{\int_a^b}f,
$$ 

y a este valor se le llama _integral de Riemann_ o _integral definida_ de $f$ en $I$ y se denota por $\int_a^b f$, o bien 

$$
\int_a^b f(x)\,dx
$$
:::

:::{.callout-note}
Si $f$ es integrable Riemann en $I$, el número $\int_a^b f(x)\,dx$ es el único número real que verifica $s(f,P)\leq \int_a^b f(x)\,dx\leq S(f,P)$ $\forall P\in\mathcal{P}(I)$.
:::

En ocasiones, omitiremos el "de Riemann" para referirnos a una integral de Riemann y simplemente se escribirá integral, cuando en el contexto esté claro que se trata de la integral de Riemann.

:::{#exm-sumas-riemann}
a. Veamos que si $f(x)=c$, es una función constante en $I=[a,b]$, entonces $f$ es integrable en $I$.

    Sea $P=\{x_0, x_1, \ldots, x_n\}$ una partición de $[a,b]$, entonces

    \begin{align*}
    s(f,P) &= \sum_{i=1}^n m_i(x_i-x_{i-1}) = \sum_{i=1}^n c(x_i-x_{i-1}) \\ 
    &= c\sum_{i=1}^n (x_i-x_{i-1}) = c(x_n-x_0) = c(b-a).
    \end{align*}

    Del mismo modo, 

    \begin{align*}
    S(f,P) &= \sum_{i=1}^n M_i(x_i-x_{i-1}) = \sum_{i=1}^n c(x_i-x_{i-1})\\ 
    & = c\sum_{i=1}^n (x_i-x_{i-1}) = c(x_n-x_0) = c(b-a).
    \end{align*}

    Así pues, $s(f,P) = S(f,P)=c(b-a)$ $\forall P\in\mathcal{P}(I)$ y $\int_a^b f(x)\,dx = c(b-a)$. 

b. Veamos que $f(x)=x$ es integrable en $[0,1]$.

    Sea $P_n=\{0, \frac{1}{n}, \frac{2}{n}, \ldots, \frac{n}{n}\}$ una partición de $[0,1]$. Vamos a probar primero que $\sup\{s(f,P_n):n\in\mathbb{N}\} = \inf\{S(f,P_n):n\in\mathbb{N}\}$. Como $f$ es creciente y continua en $[0,1]$, se cumple que 

    \begin{align*}
    m_i &= \inf\{f(x): x\in[x_{i-1},x_i]\} = f(x_{i-1}),\\ 
    M_i &= \sup\{f(x): x\in[x_{i-1},x_i]\} = f(x_i),
    \end{align*}

    y por tanto,

    \begin{align*}
    s(f,P_n) &= \sum_{i=1}^n m_i\left(\frac{i}{n}-\frac{i-1}{n}\right) = \sum_{i=1}^n f\left(\frac{i-1}{n}\right)\frac{1}{n} = \sum_{i=1}^n \frac{i-1}{n}\frac{1}{n}\\
    & = \frac{1}{n^2}\sum_{i=1}^n (i-1) =\frac{1}{n^2}\frac{(n-1)n}{2} = \frac{1}{2}\left(1-\frac{1}{n}\right),\\
    S(f,P_n) &= \sum_{i=1}^n M_i\left(\frac{i}{n}-\frac{i-1}{n}\right) = \sum_{i=1}^n f\left(\frac{i}{n}\right)\frac{1}{n} = \sum_{i=1}^n \frac{i}{n}\frac{1}{n}\\
    & = \frac{1}{n^2}\sum_{i=1}^n i =\frac{1}{n^2}\frac{n(n+1)}{2} = \frac{1}{2}\left(1+\frac{1}{n}\right).\\
    \end{align*}

    Así pues, 

    $$
    \begin{gathered}
    \sup\{s(f,P_n):n\in\mathbb{N}\} = \sup\left\{\frac{1}{2}\left(1-\frac{1}{n}\right):n\in\mathbb{N}\right\} =\frac{1}{2} \\ 
    = \inf\left\{\frac{1}{2}\left(1+\frac{1}{n}\right):n\in\mathbb{N}\right\} = \inf\{S(f,P_n):n\in\mathbb{N}\}
    \end{gathered}
    $$

    Ahora bien, como

    $$
    \begin{gathered}
    \sup\{s(f,P_n):n\in\mathbb{N}\}\leq \sup\{s(f,P):P\in\mathcal{P}(I)\} = \underline{\int_0^1} f \\
    \leq \overline{\int_0^1} f =\inf\{S(f,P):P\in\mathcal{P}(I)\} \leq \inf\{S(f,P_n):n\in\mathbb{N}\}
    \end{gathered}
    $$

    se puede concluir que $\underline{\int_0^1} f = \overline{\int_0^1} f$, y por tanto $\int_0^1 f(x)\, dx = \frac{1}{2}$.
:::

:::{#exm-funcion-no-integrable-riemann}
La función 

$$
f(x) = 
\begin{cases}
1 & \mbox{si } x\in\mathbb{Q}\cap[0,1]\\
0 & \mbox{si } x\in\mathbb{R}\setminus\mathbb{Q}\cap[0,1]
\end{cases}
$$

no es integrable Riemann ya que para cualquier partición $P=\{x_0, x_1, \ldots, x_n\}$ del intervalo $[0,1]$ se tiene que 

\begin{align*}
m_i &= \inf\{f(x): x\in [x_{i-1},x_i]\} = 0,\\
M_i &= \sup\{f(x): x\in [x_{i-1},x_i]\} = 1,
\end{align*}

por lo que $s(f,P)=0$ y $S(f,P)=1$ $\forall P\in\mathcal{P}([0,1])$.

Así pues, $\underline{\int_a^b}f = 0 \neq \overline{\int_a^b}f=1$.
:::

:::{#thm-criterio-integrabilidad-riemann}
## Criterio de integrabilidad de Riemann
Una función $f:I\to\mathbb{R}$ acotada en el intervalo $I=[a,b]$ es integrable en $I$ si y sólo si para cada $\varepsilon>0$ existe una partición $P\in\mathcal{P}(I)$ tal que $S(f,P)-s(f,P)<\varepsilon$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Supongamos que $f$ es integrable Riemann en $I$, es decir, $\underline{\int_a^b}f = \overline{\int_a^b}f$. Dado $\varepsilon>0$ existe $P\in\mathcal{P}(I)$ tal que $\underline{\int_a^b} f-\frac{\varepsilon}{2}\leq s(f,P)$ por ser $\underline{\int_a^b} f =\inf\{s(f,P): P\in \mathcal{P}(I)\}$.

Del mismo modo, por ser $\overline{\int_a^b} f =\sup\{S(f,P): P\in \mathcal{P}(I)\}$, existe una partición $Q\in\mathcal{P}(I)$ tal que $\overline{\int_a^b} f+\frac{\varepsilon}{2} \geq S(f,Q)$.

Tomando $P_\varepsilon = P\cup Q, se tiene que $s(f,P)\leq s(f,P_\varepsilon)$ y $S(f,P_\varepsilon)\leq S(f,Q)$. Así pues, 

$$
S(f,P_\varepsilon)-s(f,P_\varepsilon) \leq S(f,Q)-s(f,P) \leq \left(\overline{\int_a^b} f+\frac{\varepsilon}{2}\right) - \left(\underline{\int_a^b} f-\frac{\varepsilon}{2}\right) = \varepsilon.
$$

Para probar el otro sentido de la implicación, supongamos que para cada $\varepsilon>0$ existe una partición $P_\varepsilon\in\mathcal{P}(I)$ tal que $S(f,P_\varepsilon)-s(f,P_\varepsilon)<\varepsilon$. Entonces,

$$
0\leq \overline{\int_a^b} f- \underline{\int_a^b} f \leq S(f,P_\varepsilon)-s(f,P_\varepsilon)<\varepsilon,
$$

y como esto es cierto para cualquier $\varepsilon>0$, se tiene $\overline{\int_a^b} f=\underline{\int_a^b} f$ y $f$ es integrable Riemann.
:::
:::

:::{#cor-criterio-integrabilidad-riemann}
Dada una función $f:I\to\mathbb{R}$ acotada en el intervalo $I=[a,b]$, si existe una sucesión de particiones $(P_n)_{n=1}^\infty$ de $I$ tal que $\lim_{n\to\infty} S(f,P_n)-s(f,P_n) =0$, entonces $f$ es integrable Riemann en $I$ y 

$$
\int_a^b f(x)\,dx = \lim_{n\to\infty} s(f,P_n) = \lim_{n\to\infty} S(f,P_n).
$$
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Dado $\varepsilon>0$, como $\lim_{n\to\infty} S(f,P_n)-s(f,P_n) =0$, existe $k\in\mathbb{N}$ tal que $S(f,P_k)=s(f,P_k)<\varepsilon$, luego, por el criterio de integrabilidad de Riemann, se tiene que $f$ es integrable en $I$.

Para calcular el valor de la integral, se tiene

$$
\begin{gathered}
\lim_{n\to\infty} s(f,P_n) \leq \sup\{s(f,P):n\in\mathbb{N}\} \leq \sup\{s(f,P): P\in \mathcal{P}(I)\} = \int_a^b f(x)\, dx \\
= \inf\{S(f,P): P\in\mathcal{P}(I)\} \leq \inf\{S(f,P_n): n\in\mathbb{N}\} \leq \lim_{n\to\infty} S(f,P_n),
\end{gathered}
$$

y como $\lim_{n\to\infty} s(f,P_n) = \lim_{n\to\infty} S(f,P_n)$, las desigualdades anteriores se convierten en igualdades y por tanto, 

$$
\int_a^b f(x)\,dx = \lim_{n\to\infty} s(f,P_n) = \lim_{n\to\infty} S(f,P_n).
$$
:::
:::

:::{.callout-important}
Este último resultado nos permite calcular una integral como el límite de las sumas de Riemann tomando una sucesión de particiones cada vez más refinada.
:::

## Propiedades de la integral de Riemann

:::{#thm-linealidad-integral-riemann}
Si $f,g:I\to\mathbb{R}$ son dos funciones integrables Riemann en $I=[a,b]$, entonces

a. $f+g$ es integrable Riemann en $I$ y $\int_a^b (f+g)(x)\, dx = \int_a^b f(x)\,dx + \int_a^b f(x)\,dx.$
b. Para cualquier $c\in\mathbb{R}$, $cf$ es integrable Riemann en $I$ y  $\int_a^b cf(x)\, dx = c\int_a^b f(x)\,dx.$
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Veamos la demostración de cada apartado.

a. En primer lugar, resulta sencillo ver que para cualquier subintervalo $J$ de $I$ se cumple

    $$
    \begin{gathered}
    \inf\{(f+g)(x): x\in J\} \geq \inf\{f(x): x\in J\} + \inf\{g(x): x\in J\}\\
    \sup\{(f+g)(x): x\in J\} \leq \sup\{f(x): x\in J\} + \sup\{g(x): x\in J\}
    \end{gathered}
    $$ {#eq-1}

    Dado $\varepsilon>0$, como $f$ y $g$ son integrables, existen dos particiones $P_1,P_2\in \mathcal{P}(I)$ tales que 

    $$
    \begin{gathered}
    S(f,P_1)-s(f,P_1)\leq \frac{\varepsilon}{2}\\
    S(g,P_2)-s(g,P_2)\leq \frac{\varepsilon}{2}
    \end{gathered}
    $$

    Tomando ahora el refinamiento $P=P_1\cup P_2$ de $P_1$ y $P_2$ y la @eq-1 se tiene 

    \begin{align*}
    s(f+g,P) &\geq s(f,P) + s(g,P) \geq s(f,P_1) + s(g,P_2)\\
    S(f+g,P) &\leq S(f,P) + S(g,P) \leq S(f,P_1) + S(g,P_2)
    \end{align*}

    de manera que 

    \begin{align*}
    S(f+g,P)-s(f+g,P) &\leq (S(f,P_1)+S(g,P_2))-(s(f,P_ 1)+s(g,P_2)) \\
    &\leq \frac{\varepsilon}{2}+\frac{\varepsilon}{2} =\varepsilon.
    \end{align*}

    Y, por tanto, $f+g$ es integrable Riemann en $I$.

    Además, 

    $$
    s(f,P) + s(g,P) \leq s(f+g,P) \leq \int_a^b (f+g) \leq  S(f+g,P) \leq S(f,P) + S(g,P)
    $$

    y 

    $$
    s(f,P) + s(g,P) \leq  \int_a^b f + \int_a^b g \leq S(f,P) + S(g,P),
    $$

    por lo que se tiene

    $$
    0\leq \left|\int_a^b (f+g) - \left(\int_a^b f + \int_a^b g\right)\right| \leq (S(f,P)+S(g,P)) - (s(f,P)+s(g,P)) \leq \varepsilon,
    $$

    y por consiguiente, $\int_a^b (f+g) = \int_a^b f + \int_a^b g$.

b. Si $c=0$ entonces $cf=0$, y por tanto, $cf$ es integrable y además $\int_a^b cf = 0 = c\int_a^b f$. 

    Supongamos ahora que $c>0$. Resulta sencillo ver que para cualquier subintervalo $J$ de $I$ se cumple

    $$
    \begin{gathered}
    \inf\{(cf)(x): x\in J\} = c\inf\{f(x): x\in J\}\\
    \sup\{(cf)(x): x\in J\} = c\sup\{f(x): x\in J\}
    \end{gathered}
    $$ {#eq-2}

    de manera que si $P$ es una partición de $I$, entonces $s(cf,P)= cs(f,P)$ y $S(cf,P) = cS(f,P)$.

    Como $f$ es integrable Riemann, dado $\varepsilon>0$ existe una partición $P\in\mathcal{P}(I)$ tal que $S(f,P)-s(f,P)\leq \frac{\varepsilon}{c} >0$. Por otro lado, según la @eq-2,

    $$
    S(cf,P) - s(cf,P) = c S(f,P) - cs(f,P) = c(S(f,P)-s(f,P)) < c\frac{\varepsilon}{c} = \varepsilon,
    $$

    de manera que $cf$ es integrable en $I$, y además,

    \begin{align*}
    \int_a^b cf &= \inf\{S(cf,P): P\in \mathcal{P}(I)\} = \inf\{cS(f,P): P\in \mathcal{P}(I)\} \\
    &= c\inf\{S(f,P): P\in \mathcal{P}(I)\} = c\int_a^b f.
    \end{align*}

    Finalmente, si $c<0$, resulta sencillo ver que para cualquier subintervalo $J$ de $I$ se cumple

    $$
    \begin{gathered}
    \inf\{(cf)(x): x\in J\} = c\sup\{f(x): x\in J\}\\
    \sup\{(cf)(x): x\in J\} = c\inf\{f(x): x\in J\}
    \end{gathered}
    $$ {#eq-3}

    de manera que si $P$ es una partición de $I$, entonces $s(cf,P)= cS(f,P)$ y $S(cf,P) = cs(f,P)$.

    Como $f$ es integrable Riemann, dado $\varepsilon>0$ existe una partición $P\in\mathcal{P}(I)$ tal que $S(f,P)-s(f,P)\leq \frac{\varepsilon}{-c} >0$. Por otro lado, según la @eq-3,

    \begin{align*}
    S(cf,P) - s(cf,P) &= c s(f,P) - cS(f,P) = c(s(f,P)-S(f,P)) \\
    &= c(S(f,P)-s(f,P)) < -c\frac{\varepsilon}{-c} = \varepsilon,
    \end{align*}

    de manera que $cf$ es integrable en $I$, y además,

    \begin{align*}
    \int_a^b cf &= \inf\{S(cf,P): P\in \mathcal{P}(I)\} = \inf\{cs(f,P): P\in \mathcal{P}(I)\} \\
    &= c\sup\{s(f,P): P\in \mathcal{P}(I)\} = c\int_a^b f.
    \end{align*}
:::
:::

:::{#prp-integral-funcion-positiva}
Si $f:I\to\mathbb{R}$ es una función integrable Riemann en $I=[a,b]$ y $f(x)\geq 0$ $\forall x\in I$, entonces $\int_a^b f(x)\,dx \geq 0$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Para cualquier partición $P\in\mathcal{P}(I)$ se tiene que $f(x)$ es positiva en cualquier intervalo de la partición y por tanto $s(f,P)\geq 0$. Así pues, $\int_a^b f(x)\,dx = \sup\{s(f,P):P\in \mathcal{P}(I)\}\geq 0$.
:::
:::

:::{#cor-integral-funcion-negativa}
Si $f:I\to\mathbb{R}$ es una función integrable Riemann en $I=[a,b]$ y $f(x)\leq 0$ $\forall x\in I$, entonces $\int_a^b f(x)\,dx \leq 0$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Consideremos la función $-f(x)\geq 0$ $\forall x\in\mathbb{R}$. Como $f$ es integrable en $I$, también lo es $(-1)f$ y 

$$
\int_a^b f(x)\, dx = \int_a^b (-1)(-f(x))\,dx = - \int_a^b -f(x)\,dx \leq 0,
$$

ya que por la proposición anterior $\int_a^b -f(x)\,dx \geq 0$.
:::
:::

:::{.callout-caution}
Este resultado nos advierte de que no se puede utilizar directamente la integral de Riemann para calcular el area entre la gráfica de la función y el eje $x$ si la función presenta valores negativos en el intervalo de integración $I$.

En estos casos, el recurso habitual para calcular el área es calcular la integral del valor absoluto de la función.
:::

:::{.content-visible when-format="html"}
::: {layout-ncol=2}
![Integral de una función con valores positivos y negativos en un intervalo $I$](img/integrales/area-funcion-positiva-negativa.png)

![Cálculo del area encerrada entre una función de una función y el eje $x$ mediante la integral del valor absoluto de la función.](img/integrales/integral-valor-absoluto.png)
:::
:::

:::{.content-visible unless-format="html"}
![Suma inferior de Riemann](img/integrales/suma-inferior-riemann.pdf)
:::


:::{#cor-integral-funcion-mayor-que-otra}
Si $f,g:I\to\mathbb{R}$ son dos funciones integrables Riemann en $I=[a,b]$ y $f(x)\leq g(x)$ $\forall x\in I$, entonces $\int_a^b f(x)\,dx \leq \int_a^b g(x)\,dx$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Consideremos la función $g(x)-f(x)\geq 0$ $\forall x\in\mathbb{R}$. Como $f$ y $g$ son integrables en $I$, también lo es $g-f$ y 

$$
\int_a^b g(x)-f(x)\, dx = \int_a^b g(x)\,dx - \int_a^b f(x)\,dx \geq 0 \Rightarrow \int_a^b f(x)\,dx \leq \int_a^b g(x)\,dx.
$$
:::
:::

:::{#cor-integral-funcion-acotada}
Si $f:I\to\mathbb{R}$ es una función integrable Riemann en $I=[a,b]$ y $m\leq f(x)\leq M$ $\forall x\in I$, entonces $m(b-a)\leq \int_a^b f(x)\,dx \leq M(b-a)$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Por el corolario anterior se tiene $\int_a^b m\,dx \leq \int_a^b f(x)\,dx \leq \int_a^b M\,dx$.

Por otro lado, como $\int_a^b m\,dx = m(b-a)$ y $\int_a^b M\,dx = M(b-a)$ por tratarse de funciones constantes, sustituyendo en la desigualdad anterior se tiene

$$
m(b-a)\leq \int_a^b f(x)\,dx \leq M(b-a).
$$
:::
:::

:::{#thm-aditividad-integral-intervalo}
## Aditividad de la integral respecto del intervalo de integración
Si $f:I\to\mathbb{R}$ es una función acotada en $I=[a,b]$ y $c\in(a,b)$, entonces $f$ es integrable Riemann en $I$ si y sólo si $f$ es integrable Riemann en $[a,c]$ y $[c,b]$. Además, en este caso,

$$
\int_a^b f(x)\,dx = \int_a^c f(x)\,dx + \int_c^b f(x)\,dx
$$
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Supongamos que $f$ es integrable en $I$. Entonces, dado $\varepsilon>0$, existe $P\in\mathcal{P}(I)$ tal que $S(f,P)-s(f,P)<\varepsilon$.

Sea $Q=P\cup\{c\}\in\mathcal{P}(I)$. Como $Q$ es un refinamiento de $P$, se cumple

$$
S(f,Q)-s(f,Q) \leq S(f,P)-s(f,P) \leq \varepsilon
$$

Tomando ahora las subparticiones $Q_1=\{t\in Q:t\leq c\}$ y $Q_2=\{t\in Q: t\geq c\}$, se tiene que

$$
\begin{gathered}
(S(f,Q_1)-s(f,Q_1)) + (S(f,Q_2)-s(f,Q_2)) \\
= (S(f,Q_1) + S(f,Q_2)) - (s(f,Q_1) + s(f,Q_2)) \\
= S(f,P) - s(f,P) \leq S(f,Q) - s(f,Q) < \varepsilon,
\end{gathered}
$$

de manera que $S(f,Q_1)-s(f,Q_1)<\varepsilon$ y $S(f,Q_2)-s(f,Q_2)<\varepsilon$, y por tanto, $f$ es integrable en $[a,c]$ y en $[c,b]$. Además, 

$$
s(f,Q) = s(f,Q_1) + s(f,Q_2) \leq \int_a^c f + \int_c^b f \leq S(f,Q_1) + S(f,Q_2) = S(f,Q)
$$

para cualquier $Q\in\mathcal{P}(I)$ y $c\in Q$. Si $P\in\mathcal{P}(I)$, tomando $Q=P\cup \{c\}$, $Q$ es un refinamiento de $P$, y por tanto, 

$$
\begin{gathered}
s(f,P) \leq s(f,Q) = s(f,Q_1) + s(f,Q_2) \leq \int_a^c f + \int_c^b f \\
\leq S(f,Q_1) + S(f,Q_2) = S(f,Q) \leq S(f,P),
\end{gathered}
$$

por lo que se concluye que $\int_a^b f = \int_a^c f + \int_c^b f$.

Para probar el otro sentido de la implicación, supongamos que $f$ es integrable en $[a,c]$ y $[c,b]$. Dado $\varepsilon>0$ existe $P_1\in\mathcal{P}([a,c])$ tal que $S(f,P_1)-s(f,P_1)<\frac{\varepsilon}{2}$ y existe $P_2\in\mathcal{P}([c,b])$ tal que $S(f,P_2)-s(f,P_2)<\frac{\varepsilon}{2}$. 

Tomando ahora $P=P_1\cup P_2\in \mathcal{P}(I)$, se cumple

$$
S(f,P)-s(f,P) = s(f,P_1) + S(f,P_2) - (s(f,P_1) + s(f,P_2)) < \frac{\varepsilon}{2}+\frac{\varepsilon}{2} =\varepsilon,
$$

por lo que $f$ es integrable en $I$.
:::
:::

A pesar de que la demostración es bastante larga, cuando $f$ es positiva, es obvio que el área entre la gráfica de $f$ y el eje $x$ en el intervalo $[a,b]$ puede descomponerse en la suma de las áreas en los intervalos $[a,c]$ y $[c,b]$ para cualquier $c\in(a,b)$.


:::{.content-visible when-format="html"}
![Aditividad de la integral respecto del intervalo de integración](img/integrales/aditividad-integral.png)
:::

:::{.content-visible unless-format="html"}
![Aditividad de la integral respecto del intervalo de integración](img/integrales/aditividad-integral.pdf)
:::


## Clase de las funciones integrables

A continuación trataremos de estudiar qué tipo de funciones son integrables.

:::{#thm-integrabilidad-funciones-monotonas}
Si $f:I\to\mathbb{R}$ es una función acotada y monótona en $I=[a,b]$, entonces  $f$ es integrable en $I$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Supongamos que $f$ es creciente en $I$. Dado $\varepsilon>0$ existe un $n\in\mathbb{N}$ tal que

$$
\frac{(f(b)-f(a))(b-a)}{n} < \varepsilon.
$$

Sea ahora $P_n\in\mathcal{P}(I)$ la partición que divide $I$ en $n$ subintervalos de igual longitud, es decir, $P=\{x_0, x_1, \ldots, x_n\}$ con $x_i = a+\frac{(b-a)i}{n}$.

Como $f$ es creciente en $I$ se tiene 

\begin{align*}
m_i &= \inf\{f(x): x\in[x_{i-1},x_i]\} = f(x_{i-1})\\
M_i &= \sup\{f(x): x\in[x_{i-1},x_i]\} = f(x_{i})
\end{align*}
para $i=1,\ldots,n$, de manera que 

\begin{align*}
S(f,P_n)-s(f,P_n) &= \sum_{i=1}^n f(x_i)(x_i-x_{i-1}) - \sum_{i=1}^n f(x_{i-1})(x_i-x_{i-1}) \\
&= \sum_{i=1}^n (f(x_i)-f(x_{i-1}))\frac{b-a}{n} \\
&= \frac{b-1}{n}(f(x_1)-f(x_0))+(f(x_2)-f(x_1))+ \cdots \\ 
& \cdots + (f(x_{n-1})-f(x_{n-2})+ (f(x_n)-f(x_{n-1}))) \\
&= \frac{b-a}{n}(f(b)-f(a)) < \varepsilon.
\end{align*}

Así pues, $f$ es integrable en $I$.
:::
:::

:::{#thm-integrabilidad-funciones-monotonas}
Si $f:I\to\mathbb{R}$ es una función continua en $I=[a,b]$, entonces  $f$ es integrable en $I$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Observemos primero que como $f$ es continua en $I$, entonces es uniformemente continua en $I$ al ser $I$ un intervalo cerrado.

Dado $\varepsilon>0$, como $f$ es uniformemente continua en $I$, para $\varepsilon'=\frac{\varepsilon}{b-a}>0$ existe $\delta>0$ tal que si $|x-y|<\delta$ entonces $|f(x)-f(y)|<\varepsilon'$. 

Sea $P=\{x_0,x_1,\ldots,x_n\}$ una partición que divide $I$ en subintervalos de longitud menor que $\delta$. Entonces, para cad $i=1,\ldots, n$ se tiene 

$$
M_i-m_i = \sup\{|f(x)-f(y)|: x,y\in[x_{i-1},x_i]\} \leq \varepsilon',
$$
 
y por tanto,

\begin{align*}
S(f,P)-s(f,P) &= \sum_{i=1}^n M_i(x_i-x_{i-1}) - \sum_{i=1}^n m_i(x_i-x_{i-1}) \\
&= \sum_{i=1}^n (M_i-m_i)(x_i-x_{i-1})\\
& < \varepsilon' \sum_{i=1}^n (x_i-x_{i-1}) = \varepsilon' (b-a)  = \varepsilon.
\end{align*}
:::
:::