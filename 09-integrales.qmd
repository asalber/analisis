---
title: Integrales de funciones
crossref:
    chapters: true
lang: es
---

::: {.content-visible unless-format="pdf"}
{{< include macros.qmd >}}
:::

En este capítulo se estudian las _integrales_ de números reales, que junto a las derivadas son las dos ramas del Análisis más importantes. Veremos también el _teorema fundamental del cálculo_, uno de los resultados más importantes del Análisis que relaciona el cálculo diferencial con el integral, al cuál llegaron de manera simultanea Newton y Leibniz.

Históricamente el concepto de integral surge a partir del estudio de áreas, inicialmente de figuras geométricas, y después, de figuras curvas. En la antigua Grecia ya se utilizaba el _[método por agotamiento](https://es.wikipedia.org/wiki/M%C3%A9todo_por_agotamiento)_ para calcular áreas de figuras no geométricas, y Arquímedes fue capaz de aproximar el área encerrada por una circunferencia usando este método.

Para llegar a la definición de integral explotaremos este método aproximando el area bajo una función usando rectángulos. El precursor de esta idea fue [Bernhard Riemann](https://es.wikipedia.org/wiki/Bernhard_Riemann).

## Sumas de Riemann

:::{#def-particion-intervalo}
## Partición de un intervalo
Dado un intervalo $I=[a,b]$ cerrado y acotado en $\mathbb{R}$, una _partición_ de $I$ es un conjunto ordenado y finito $P=\{x_0, x_1, \ldots, x_n\}$ de puntos de $I$ tales que $a=x_0<x_1<x_2<\cdots<x_n=b$.

El conjunto de todas las particiones de un intervalo $I$ se denota $\mathcal{P}(I)$.
:::

:::{#def-suma-inferior-riemann}
## Suma inferior de Riemann
Dada una función $f: I\to\mathbb{R}$ acotada en el intervalo $I=[a,b]$ y una partición $P=\{x_0, x_1, \ldots, x_n\}$ de $I$, se define la _suma inferior_ de $f$ respecto de $P$, y se denota $s(f,P)$, como

$$
s(f,P) = \sum_{i=1}^n m_i(x_i-x_{i-1})
$$

donde $m_i=\inf\{f(x): x\in[x_{i-1},x_i]\}$ para $i=1,\ldots,n$.
:::

Gráficamente, si $f$ es una función positiva, la suma inferior se puede interpretar como la suma de las areas de los rectángulos con base $[x_{i-1},x_i]$ y altura $m_i$.

:::{.content-visible when-format="html"}
![Suma inferior de Riemann](img/integrales/suma-inferior-riemann.png)
:::

:::{.content-visible unless-format="html"}
![Suma inferior de Riemann](img/integrales/suma-inferior-riemann.pdf)
:::

:::{#def-suma-superior-riemann}
## Suma superior de Riemann
Dada una función $f: I\to\mathbb{R}$ acotada en el intervalo $I=[a,b]$ y una partición $P=\{x_0, x_1, \ldots, x_n\}$ de $I$, se define la _suma superior_ de $f$ respecto de $P$, y se denota $S(f,P)$, como

$$
S(f,P) = \sum_{i=1}^n M_i(x_i-x_{i-1})
$$

donde $M_i=\sup\{f(x): x\in[x_{i-1},x_i]\}$ para $i=1,\ldots,n$.
:::

Gráficamente, si $f$ es una función positiva, la suma superior se puede interpretar como la suma de las areas de los rectángulos con base $[x_{i-1},x_i]$ y altura $M_i$.

:::{.content-visible when-format="html"}
![Suma superior de Riemann](img/integrales/suma-superior-riemann.png)
:::

:::{.content-visible unless-format="html"}
![Suma inferior de Riemann](img/integrales/suma-superior-riemann.pdf)
:::

:::{.callout-warning}
Obsérvese que si una función es negativa en un intervalo $I$, sus sumas de Riemann son negativas, ya que las alturas de los rectángulos son negativas.

:::{.content-visible when-format="html"}
![Sumas de Riemann de una función con valores positivos y negativos en un intervalo.](img/integrales/sumas-riemann-positivas-negativas.png)
:::

:::{.content-visible unless-format="html"}
![Sumas de Riemann de una función con valores positivos y negativos en un intervalo.](img/integrales/sumas-riemann-positivas-negativas.pdf)
:::
:::

::: {.content-visible when-format="html"}
<div id="ggb-suma-riemann-1"></div>

<script>
var params = {
            "appName": "classic", 
            "width": 800, 
            "height": 500, 
            "showToolBar": false, 
            "showAlgebraInput": false, 
            "showMenuBar": false,
            "borderColor": "#FFFFFF",
            "enableRightClick": false,
            "enableLabelDrags": false,
            "enableShiftDragZoom": false,
            "showZoomButtons": false,
            "showResetIcon": true,
            //"showFullscreenButton": true,
            "transparentGraphics": true,
            "material_id":"m9bz6w25"
            };
    var ggbApplet1 = new GGBApplet(params, true);
    window.addEventListener("load", function() { 
        ggbApplet1.inject('ggb-suma-riemann-1');
    });
</script>
:::

[![Calculadora de sumas de Riemann](/img/logos/logo-geogebra.png) Calculadora de sumas de Riemann](https://www.geogebra.org/classic/nr6x8pjq)

:::{#prp-sumas-riemann-inferior-superior}
Si $f:I\to\mathbb{R}$ es una función acotada en el intervalo $I=[a,b]$ y $P=\{x_0, x_1, \cdots, x_n\}$ es una partición de $I$, entonces $s(f,P)\leq S(f,P)$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Para cada $i=1,\ldots,n$ se tiene que 

$$
m_i=\inf\{f(x): x\in[x_{i-1},x_i]\}\leq \sup\{f(x): x\in[x_{i-1},x_i]\} = M_i,
$$

de manera que

$$
s(f,P) = \sum_{i=1}^n m_i(x_i-x_{i-1}) \leq \sum_{i=1}^n M_i(x_i-x_{i-1}) = S(f,P),
$$

ya que $(x_i-x_{i-1})>0$ $\forall i=1,\ldots,n$.
:::
:::

:::{#def-refinamiento-particion}
## Refinamiento de una partición
Dadas dos particiones $P=\{x_0, x_1, \ldots, x_n\}$ y $Q=\{y_0, y_1, \ldots, y_m\}$ de un intervalo $I=[a,b]$, se dice que $Q$ es un refinamiento de $P$ si todos los puntos de $P$ están en $Q$, es decir, $P\subseteq Q$.
:::

:::{#prp-sumas-riemann-refinamiento}
Si $f:I\to\mathbb{R}$ es una función acotada en el intervalo $I=[a,b]$, $P$ es una partición de $I$ y $Q$ es un refinamiento de $P$, entonces

a. $s(f,P)\leq S(f,Q)$
b. $s(f,Q)\leq S(f,P)$
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Veremos solo la prueba para las sumas inferiores.

a. Probaremos primero el resultado para un refinamiento con un punto más. Sea $P=\{x_0, x_1, \cdots, x_n\}$ y supongamos que $Q$ solo tiene un punto $c$ más que $P$. Sea $k\in\{1,\ldots,n\}$ tal que $c\in[x_{k-1},x_k]$ y tomemos $m_k'=\inf\{f(x): x\in[x_{k-1},c]\}$ y $m_k''=\inf\{f(x): x\in[c,x_k]\}$. Como $m_k=\inf\{f(x): x\in[x_{k-1},x_k]\}$ resulta evidente que $m_k\leq m_k'$ y $m_k\leq m_k''$, por lo que 

    $$
    m_k(x_k-x_{k-1}) = m_k(x_k-c)+m_k(c-x_{k-1})\leq m_k''(x_k-c)+m_k'(c-x_{k-1})
    $$

    y entonces

    \begin{align*}
    s(f,P) &= \sum_{i=1}^n m_i(x_i-x_{i-1}) = \sum_{i=1,i\neq k}^n m_i(x_i-x_{i-1}) + m_k(x_k-x_{k-1}) \\ &\leq \sum_{i=1,i\neq k}^n m_i(x_i-x_{i-1}) + m_k''(x_k-c) + m_k'(c-x_{k-1}) = s(f,Q).
    \end{align*}
    
    Para probar el caso general, si $Q$ es un refinamiento cualquiera de $P$, entonces existe una sucesión finita de particiones de $I$, $P_1,P_2,\ldots,P_r$ tales que  $P=P_1\subset P_2\subset\cdots \subset P_r=Q$ y cada $P_i$ tiene solo un punto más que $P_{i-1}$. Así pues, por el resultado anterior, 

    $$
    s(f,P)\leq s(f,P_2)\leq \cdots \leq s(f,Q).
    $$

b. La prueba para las sumas superiores es análoga y se deja como ejercicio.
:::
:::

:::{#prp-sumas-riemann-particiones}
Si $f:I\to\mathbb{R}$ es una función acotada en el intervalo $I=[a,b]$ y $P$ y $Q$ son dos particiones de $I$, entonces $s(f,P)\leq S(f,Q)$ y $s(f,Q)\leq S(f,P)$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Tomando la partición de $I$ $P'=P\cup Q$, se tiene que $P'$ es un refinamiento de $P$ y $Q$, de manera que, según las proposiciones anteriores se tiene 

$$
s(f,P)\leq s(f,P')\leq S(f,P')\leq S(f,Q)
$$

y

$$
s(f,Q)\leq s(f,P')\leq S(f,P')\leq S(f,P).
$$
:::
:::

## Integrales de Riemann

Como acabamos de ver, dada una función $f$ positiva en un intervalo $I$, para cualquier partición $P$ de $I$, la suma inferior de Riemann es una aproximación por defecto del área encerrada entre la gráfica de $f$ y el eje $x$ en el intervalo $I$, mientras que la suma superior de Riemann es una aproximación por exceso. Si al hacer refinamientos de la partición $P$, cada vez con un mayor número de subintervalos, las sumas inferiores crecen y las superiores decrecen, se obtienen aproximaciones cada vez mejores. Podemos explotar esta idea para calcular el area área encerrada entre la gráfica de $f$ y el eje $x$ tomando particiones con subintervalos cada vez más pequeños.

:::{.content-visible when-format="html"}
![Aproximación del area encerrada entre la gráfica de una función y el eje $x$ mediante sumas de Riemann.](img/integrales/sumas_riemann.gif)
:::

:::{#def-integral-inferior-riemann}
## Integral inferior de Riemann
Dada una función $f:I\to\mathbb{R}$ acotada en el intervalo $I=[a,b]$, se define la _integral inferior_ de $f$ en $I$ como el número $\underline{\int_a^b} f =\sup\{s(f,P): P\in \mathcal{P}(I)\}$.
:::

:::{#def-integral-superior-riemann}
## Integral superior de Riemann
Dada una función $f:I\to\mathbb{R}$ acotada en el intervalo $I=[a,b]$, se define la _integral superior_ de $f$ en $I$ como el número $\overline{\int_a^b} f =\inf\{S(f,P): P\in \mathcal{P}(I)\}$.
:::

:::{#prp-integral-riemann-inferior-superior}
Si $f:I\to\mathbb{R}$ es una función acotada en el intervalo $I=[a,b]$, entonces $\underline{\int_a^b} f\leq \overline{\int_a^b}f$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Sean $P$ y $Q$ dos particiones cualesquiera de $I$. Por la proposición anterior, $s(f,P)\leq S(f,Q)$ $\forall P\in\mathcal(P)(I)$, de modo que $S(f,Q)$ es una cota superior de todas las sumas inferiores, y por tanto,

$$
\underline{\int_a^b} f =  \sup\{s(f,P): P\in\mathcal{P}(I)\}\leq S(f,Q)
$$

Como esto es cierto para cualquier partición $Q$, se tiene que $\underline{\int_a^b} f$ es una cota inferior de todas las sumas superiores, y por tanto,

$$
\underline{\int_a^b} f \leq \inf\{S(f,Q): Q\in\mathcal{P}(I)\} = \overline{\int_a^b}f.
$$
:::
::: 

:::{#def-integral-riemann}
Dada una función $f:I\to\mathbb{R}$ acotada en el intervalo $I=[a,b]$, se dice que $f$ es _integrable Riemann_ en $I$ si 

$$
\underline{\int_a^b} f = \overline{\int_a^b}f,
$$ 

y a este valor se le llama _integral de Riemann_ o _integral definida_ de $f$ en $I$ y se denota por $\int_a^b f$, o bien 

$$
\int_a^b f(x)\,dx
$$
:::

:::{.callout-note}
Si $f$ es integrable Riemann en $I$, el número $\int_a^b f(x)\,dx$ es el único número real que verifica $s(f,P)\leq \int_a^b f(x)\,dx\leq S(f,P)$ $\forall P\in\mathcal{P}(I)$.
:::

En ocasiones, omitiremos el "de Riemann" para referirnos a una integral de Riemann y simplemente se escribirá integral, cuando en el contexto esté claro que se trata de la integral de Riemann.

:::{#exm-sumas-riemann}
a. Veamos que si $f(x)=c$, es una función constante en $I=[a,b]$, entonces $f$ es integrable en $I$.

    Sea $P=\{x_0, x_1, \ldots, x_n\}$ una partición de $[a,b]$, entonces

    \begin{align*}
    s(f,P) &= \sum_{i=1}^n m_i(x_i-x_{i-1}) = \sum_{i=1}^n c(x_i-x_{i-1}) \\ 
    &= c\sum_{i=1}^n (x_i-x_{i-1}) = c(x_n-x_0) = c(b-a).
    \end{align*}

    Del mismo modo, 

    \begin{align*}
    S(f,P) &= \sum_{i=1}^n M_i(x_i-x_{i-1}) = \sum_{i=1}^n c(x_i-x_{i-1})\\ 
    & = c\sum_{i=1}^n (x_i-x_{i-1}) = c(x_n-x_0) = c(b-a).
    \end{align*}

    Así pues, $s(f,P) = S(f,P)=c(b-a)$ $\forall P\in\mathcal{P}(I)$ y $\int_a^b f(x)\,dx = c(b-a)$. 

b. Veamos que $f(x)=x$ es integrable en $[0,1]$.

    Sea $P_n=\{0, \frac{1}{n}, \frac{2}{n}, \ldots, \frac{n}{n}\}$ una partición de $[0,1]$. Vamos a probar primero que $\sup\{s(f,P_n):n\in\mathbb{N}\} = \inf\{S(f,P_n):n\in\mathbb{N}\}$. Como $f$ es creciente y continua en $[0,1]$, se cumple que 

    \begin{align*}
    m_i &= \inf\{f(x): x\in[x_{i-1},x_i]\} = f(x_{i-1}),\\ 
    M_i &= \sup\{f(x): x\in[x_{i-1},x_i]\} = f(x_i),
    \end{align*}

    y por tanto,

    \begin{align*}
    s(f,P_n) &= \sum_{i=1}^n m_i\left(\frac{i}{n}-\frac{i-1}{n}\right) = \sum_{i=1}^n f\left(\frac{i-1}{n}\right)\frac{1}{n} = \sum_{i=1}^n \frac{i-1}{n}\frac{1}{n}\\
    & = \frac{1}{n^2}\sum_{i=1}^n (i-1) =\frac{1}{n^2}\frac{(n-1)n}{2} = \frac{1}{2}\left(1-\frac{1}{n}\right),\\
    S(f,P_n) &= \sum_{i=1}^n M_i\left(\frac{i}{n}-\frac{i-1}{n}\right) = \sum_{i=1}^n f\left(\frac{i}{n}\right)\frac{1}{n} = \sum_{i=1}^n \frac{i}{n}\frac{1}{n}\\
    & = \frac{1}{n^2}\sum_{i=1}^n i =\frac{1}{n^2}\frac{n(n+1)}{2} = \frac{1}{2}\left(1+\frac{1}{n}\right).\\
    \end{align*}

    Así pues, 

    $$
    \begin{gathered}
    \sup\{s(f,P_n):n\in\mathbb{N}\} = \sup\left\{\frac{1}{2}\left(1-\frac{1}{n}\right):n\in\mathbb{N}\right\} =\frac{1}{2} \\ 
    = \inf\left\{\frac{1}{2}\left(1+\frac{1}{n}\right):n\in\mathbb{N}\right\} = \inf\{S(f,P_n):n\in\mathbb{N}\}
    \end{gathered}
    $$

    Ahora bien, como

    $$
    \begin{gathered}
    \sup\{s(f,P_n):n\in\mathbb{N}\}\leq \sup\{s(f,P):P\in\mathcal{P}(I)\} = \underline{\int_0^1} f \\
    \leq \overline{\int_0^1} f =\inf\{S(f,P):P\in\mathcal{P}(I)\} \leq \inf\{S(f,P_n):n\in\mathbb{N}\}
    \end{gathered}
    $$

    se puede concluir que $\underline{\int_0^1} f = \overline{\int_0^1} f$, y por tanto $\int_0^1 f(x)\, dx = \frac{1}{2}$.
:::

:::{#exm-funcion-no-integrable-riemann}
La función 

$$
f(x) = 
\begin{cases}
1 & \mbox{si } x\in\mathbb{Q}\cap[0,1]\\
0 & \mbox{si } x\in\mathbb{R}\setminus\mathbb{Q}\cap[0,1]
\end{cases}
$$

no es integrable Riemann ya que para cualquier partición $P=\{x_0, x_1, \ldots, x_n\}$ del intervalo $[0,1]$ se tiene que 

\begin{align*}
m_i &= \inf\{f(x): x\in [x_{i-1},x_i]\} = 0,\\
M_i &= \sup\{f(x): x\in [x_{i-1},x_i]\} = 1,
\end{align*}

por lo que $s(f,P)=0$ y $S(f,P)=1$ $\forall P\in\mathcal{P}([0,1])$.

Así pues, $\underline{\int_a^b}f = 0 \neq \overline{\int_a^b}f=1$.
:::

:::{#thm-criterio-integrabilidad-riemann}
## Criterio de integrabilidad de Riemann
Una función $f:I\to\mathbb{R}$ acotada en el intervalo $I=[a,b]$ es integrable en $I$ si y sólo si para cada $\varepsilon>0$ existe una partición $P\in\mathcal{P}(I)$ tal que $S(f,P)-s(f,P)<\varepsilon$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Supongamos que $f$ es integrable Riemann en $I$, es decir, $\underline{\int_a^b}f = \overline{\int_a^b}f$. Dado $\varepsilon>0$ existe $P_1\in\mathcal{P}(I)$ tal que $\underline{\int_a^b} f-\frac{\varepsilon}{2}\leq s(f,P_1)$ por ser $\underline{\int_a^b} f =\sup\{s(f,P): P\in \mathcal{P}(I)\}$.

Del mismo modo, por ser $\overline{\int_a^b} f =\inf\{S(f,P): P\in \mathcal{P}(I)\}$, existe una partición $P_2\in\mathcal{P}(I)$ tal que $\overline{\int_a^b} f+\frac{\varepsilon}{2} \geq S(f,P_2)$.

Tomando $P = P_1\cup P_2$, se tiene que $s(f,P_1)\leq s(f,P)$ y $S(f,P)\leq S(f,P_2)$. Así pues, 

$$
S(f,P)-s(f,P) \leq S(f,P_2)-s(f,P_1) \leq \left(\overline{\int_a^b} f+\frac{\varepsilon}{2}\right) - \left(\underline{\int_a^b} f-\frac{\varepsilon}{2}\right) = \varepsilon.
$$

Para probar el otro sentido de la implicación, supongamos que para cada $\varepsilon>0$ existe una partición $P\in\mathcal{P}(I)$ tal que $S(f,P)-s(f,P)<\varepsilon$. Entonces,

$$
0\leq \overline{\int_a^b} f- \underline{\int_a^b} f \leq S(f,P)-s(f,P)<\varepsilon,
$$

y como esto es cierto para cualquier $\varepsilon>0$, se tiene $\overline{\int_a^b} f=\underline{\int_a^b} f$ y $f$ es integrable Riemann.
:::
:::

:::{#cor-criterio-integrabilidad-riemann}
Dada una función $f:I\to\mathbb{R}$ acotada en el intervalo $I=[a,b]$, si existe una sucesión de particiones $(P_n)_{n=1}^\infty$ de $I$ tal que $\lim_{n\to\infty} S(f,P_n)-s(f,P_n) =0$, entonces $f$ es integrable Riemann en $I$ y 

$$
\int_a^b f(x)\,dx = \lim_{n\to\infty} s(f,P_n) = \lim_{n\to\infty} S(f,P_n).
$$
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Dado $\varepsilon>0$, como $\lim_{n\to\infty} S(f,P_n)-s(f,P_n) =0$, existe $k\in\mathbb{N}$ tal que $S(f,P_k)=s(f,P_k)<\varepsilon$, luego, por el criterio de integrabilidad de Riemann, se tiene que $f$ es integrable en $I$.

Para calcular el valor de la integral, se tiene

$$
\begin{gathered}
\lim_{n\to\infty} s(f,P_n) \leq \sup\{s(f,P):n\in\mathbb{N}\} \leq \sup\{s(f,P): P\in \mathcal{P}(I)\} = \int_a^b f(x)\, dx \\
= \inf\{S(f,P): P\in\mathcal{P}(I)\} \leq \inf\{S(f,P_n): n\in\mathbb{N}\} \leq \lim_{n\to\infty} S(f,P_n),
\end{gathered}
$$

y como $\lim_{n\to\infty} s(f,P_n) = \lim_{n\to\infty} S(f,P_n)$, las desigualdades anteriores se convierten en igualdades y por tanto, 

$$
\int_a^b f(x)\,dx = \lim_{n\to\infty} s(f,P_n) = \lim_{n\to\infty} S(f,P_n).
$$
:::
:::

:::{.callout-important}
Este último resultado nos permite calcular una integral como el límite de las sumas de Riemann tomando una sucesión de particiones cada vez más refinada.
:::

## Propiedades de la integral de Riemann

:::{#thm-linealidad-integral-riemann}
Si $f,g:I\to\mathbb{R}$ son dos funciones integrables Riemann en $I=[a,b]$, entonces

a. $f+g$ es integrable Riemann en $I$ y $\int_a^b (f+g)(x)\, dx = \int_a^b f(x)\,dx + \int_a^b f(x)\,dx.$
b. Para cualquier $c\in\mathbb{R}$, $cf$ es integrable Riemann en $I$ y  $\int_a^b cf(x)\, dx = c\int_a^b f(x)\,dx.$
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Veamos la demostración de cada apartado.

a. En primer lugar, resulta sencillo ver que para cualquier subintervalo $J$ de $I$ se cumple

    $$
    \begin{gathered}
    \inf\{(f+g)(x): x\in J\} \geq \inf\{f(x): x\in J\} + \inf\{g(x): x\in J\}\\
    \sup\{(f+g)(x): x\in J\} \leq \sup\{f(x): x\in J\} + \sup\{g(x): x\in J\}
    \end{gathered}
    $$ {#eq-1}

    Dado $\varepsilon>0$, como $f$ y $g$ son integrables, existen dos particiones $P_1,P_2\in \mathcal{P}(I)$ tales que 

    $$
    \begin{gathered}
    S(f,P_1)-s(f,P_1)\leq \frac{\varepsilon}{2}\\
    S(g,P_2)-s(g,P_2)\leq \frac{\varepsilon}{2}
    \end{gathered}
    $$

    Tomando ahora el refinamiento $P=P_1\cup P_2$ de $P_1$ y $P_2$ y la @eq-1 se tiene 

    \begin{align*}
    s(f+g,P) &\geq s(f,P) + s(g,P) \geq s(f,P_1) + s(g,P_2)\\
    S(f+g,P) &\leq S(f,P) + S(g,P) \leq S(f,P_1) + S(g,P_2)
    \end{align*}

    de manera que 

    \begin{align*}
    S(f+g,P)-s(f+g,P) &\leq (S(f,P_1)+S(g,P_2))-(s(f,P_ 1)+s(g,P_2)) \\
    &\leq \frac{\varepsilon}{2}+\frac{\varepsilon}{2} =\varepsilon.
    \end{align*}

    Y, por tanto, $f+g$ es integrable Riemann en $I$.

    Además, 

    $$
    s(f,P) + s(g,P) \leq s(f+g,P) \leq \int_a^b (f+g) \leq  S(f+g,P) \leq S(f,P) + S(g,P)
    $$

    y 

    $$
    s(f,P) + s(g,P) \leq  \int_a^b f + \int_a^b g \leq S(f,P) + S(g,P),
    $$

    por lo que se tiene

    $$
    0\leq \left|\int_a^b (f+g) - \left(\int_a^b f + \int_a^b g\right)\right| \leq (S(f,P)+S(g,P)) - (s(f,P)+s(g,P)) \leq \varepsilon,
    $$

    y por consiguiente, $\int_a^b (f+g) = \int_a^b f + \int_a^b g$.

b. Si $c=0$ entonces $cf=0$, y por tanto, $cf$ es integrable y además $\int_a^b cf = 0 = c\int_a^b f$. 

    Supongamos ahora que $c>0$. Resulta sencillo ver que para cualquier subintervalo $J$ de $I$ se cumple

    $$
    \begin{gathered}
    \inf\{(cf)(x): x\in J\} = c\inf\{f(x): x\in J\}\\
    \sup\{(cf)(x): x\in J\} = c\sup\{f(x): x\in J\}
    \end{gathered}
    $$ {#eq-2}

    de manera que si $P$ es una partición de $I$, entonces $s(cf,P)= cs(f,P)$ y $S(cf,P) = cS(f,P)$.

    Como $f$ es integrable Riemann, dado $\varepsilon>0$ existe una partición $P\in\mathcal{P}(I)$ tal que $S(f,P)-s(f,P)\leq \frac{\varepsilon}{c} >0$. Por otro lado, según la @eq-2,

    $$
    S(cf,P) - s(cf,P) = c S(f,P) - cs(f,P) = c(S(f,P)-s(f,P)) < c\frac{\varepsilon}{c} = \varepsilon,
    $$

    de manera que $cf$ es integrable en $I$, y además,

    \begin{align*}
    \int_a^b cf &= \inf\{S(cf,P): P\in \mathcal{P}(I)\} = \inf\{cS(f,P): P\in \mathcal{P}(I)\} \\
    &= c\inf\{S(f,P): P\in \mathcal{P}(I)\} = c\int_a^b f.
    \end{align*}

    Finalmente, si $c<0$, resulta sencillo ver que para cualquier subintervalo $J$ de $I$ se cumple

    $$
    \begin{gathered}
    \inf\{(cf)(x): x\in J\} = c\sup\{f(x): x\in J\}\\
    \sup\{(cf)(x): x\in J\} = c\inf\{f(x): x\in J\}
    \end{gathered}
    $$ {#eq-3}

    de manera que si $P$ es una partición de $I$, entonces $s(cf,P)= cS(f,P)$ y $S(cf,P) = cs(f,P)$.

    Como $f$ es integrable Riemann, dado $\varepsilon>0$ existe una partición $P\in\mathcal{P}(I)$ tal que $S(f,P)-s(f,P)\leq \frac{\varepsilon}{-c} >0$. Por otro lado, según la @eq-3,

    \begin{align*}
    S(cf,P) - s(cf,P) &= c s(f,P) - cS(f,P) = c(s(f,P)-S(f,P)) \\
    &= c(S(f,P)-s(f,P)) < -c\frac{\varepsilon}{-c} = \varepsilon,
    \end{align*}

    de manera que $cf$ es integrable en $I$, y además,

    \begin{align*}
    \int_a^b cf &= \inf\{S(cf,P): P\in \mathcal{P}(I)\} = \inf\{cs(f,P): P\in \mathcal{P}(I)\} \\
    &= c\sup\{s(f,P): P\in \mathcal{P}(I)\} = c\int_a^b f.
    \end{align*}
:::
:::

:::{#prp-integral-funcion-positiva}
Si $f:I\to\mathbb{R}$ es una función integrable Riemann en $I=[a,b]$ y $f(x)\geq 0$ $\forall x\in I$, entonces $\int_a^b f(x)\,dx \geq 0$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Para cualquier partición $P\in\mathcal{P}(I)$ se tiene que $f(x)$ es positiva en cualquier intervalo de la partición y por tanto $s(f,P)\geq 0$. Así pues, $\int_a^b f(x)\,dx = \sup\{s(f,P):P\in \mathcal{P}(I)\}\geq 0$.
:::
:::

:::{#cor-integral-funcion-negativa}
Si $f:I\to\mathbb{R}$ es una función integrable Riemann en $I=[a,b]$ y $f(x)\leq 0$ $\forall x\in I$, entonces $\int_a^b f(x)\,dx \leq 0$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Consideremos la función $-f(x)\geq 0$ $\forall x\in\mathbb{R}$. Como $f$ es integrable en $I$, también lo es $(-1)f$ y 

$$
\int_a^b f(x)\, dx = \int_a^b (-1)(-f(x))\,dx = - \int_a^b -f(x)\,dx \leq 0,
$$

ya que por la proposición anterior $\int_a^b -f(x)\,dx \geq 0$.
:::
:::

:::{.callout-caution}
Este resultado nos advierte de que no se puede utilizar directamente la integral de Riemann para calcular el area entre la gráfica de la función y el eje $x$ si la función presenta valores negativos en el intervalo de integración $I$.

En estos casos, el recurso habitual para calcular el área es calcular la integral del valor absoluto de la función.
:::

:::{.content-visible when-format="html"}
::: {layout-ncol=2}
![Integral de una función con valores positivos y negativos en un intervalo $I$](img/integrales/area-funcion-positiva-negativa.png)

![Cálculo del area encerrada entre una función de una función y el eje $x$ mediante la integral del valor absoluto de la función.](img/integrales/integral-valor-absoluto.png)
:::
:::

:::{.content-visible unless-format="html"}
::: {layout-ncol=2}
![Integral de una función con valores positivos y negativos en un intervalo $I$](img/integrales/area-funcion-positiva-negativa.pdf)

![Cálculo del area encerrada entre una función de una función y el eje $x$ mediante la integral del valor absoluto de la función.](img/integrales/integral-valor-absoluto.pdf)
:::
:::


:::{#cor-integral-funcion-mayor-que-otra}
Si $f,g:I\to\mathbb{R}$ son dos funciones integrables Riemann en $I=[a,b]$ y $f(x)\leq g(x)$ $\forall x\in I$, entonces $\int_a^b f(x)\,dx \leq \int_a^b g(x)\,dx$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Consideremos la función $g(x)-f(x)\geq 0$ $\forall x\in\mathbb{R}$. Como $f$ y $g$ son integrables en $I$, también lo es $g-f$ y 

$$
\int_a^b g(x)-f(x)\, dx = \int_a^b g(x)\,dx - \int_a^b f(x)\,dx \geq 0 \Rightarrow \int_a^b f(x)\,dx \leq \int_a^b g(x)\,dx.
$$
:::
:::

:::{#cor-integral-funcion-acotada}
Si $f:I\to\mathbb{R}$ es una función integrable Riemann en $I=[a,b]$ y $m\leq f(x)\leq M$ $\forall x\in I$, entonces $m(b-a)\leq \int_a^b f(x)\,dx \leq M(b-a)$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Por el corolario anterior se tiene $\int_a^b m\,dx \leq \int_a^b f(x)\,dx \leq \int_a^b M\,dx$.

Por otro lado, como $\int_a^b m\,dx = m(b-a)$ y $\int_a^b M\,dx = M(b-a)$ por tratarse de funciones constantes, sustituyendo en la desigualdad anterior se tiene

$$
m(b-a)\leq \int_a^b f(x)\,dx \leq M(b-a).
$$
:::
:::

:::{#thm-aditividad-integral-intervalo}
## Aditividad de la integral respecto del intervalo de integración
Si $f:I\to\mathbb{R}$ es una función acotada en $I=[a,b]$ y $c\in(a,b)$, entonces $f$ es integrable Riemann en $I$ si y sólo si $f$ es integrable Riemann en $[a,c]$ y $[c,b]$. Además, en este caso,

$$
\int_a^b f(x)\,dx = \int_a^c f(x)\,dx + \int_c^b f(x)\,dx
$$
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Supongamos que $f$ es integrable en $I$. Entonces, dado $\varepsilon>0$, existe $P\in\mathcal{P}(I)$ tal que $S(f,P)-s(f,P)<\varepsilon$.

Sea $Q=P\cup\{c\}\in\mathcal{P}(I)$. Como $Q$ es un refinamiento de $P$, se cumple

$$
S(f,Q)-s(f,Q) \leq S(f,P)-s(f,P) \leq \varepsilon
$$

Tomando ahora las subparticiones $Q_1=\{t\in Q:t\leq c\}$ y $Q_2=\{t\in Q: t\geq c\}$, se tiene que

$$
\begin{gathered}
(S(f,Q_1)-s(f,Q_1)) + (S(f,Q_2)-s(f,Q_2)) \\
= (S(f,Q_1) + S(f,Q_2)) - (s(f,Q_1) + s(f,Q_2)) \\
= S(f,P) - s(f,P) \leq S(f,Q) - s(f,Q) < \varepsilon,
\end{gathered}
$$

de manera que $S(f,Q_1)-s(f,Q_1)<\varepsilon$ y $S(f,Q_2)-s(f,Q_2)<\varepsilon$, y por tanto, $f$ es integrable en $[a,c]$ y en $[c,b]$. Además, 

$$
s(f,Q) = s(f,Q_1) + s(f,Q_2) \leq \int_a^c f + \int_c^b f \leq S(f,Q_1) + S(f,Q_2) = S(f,Q)
$$

para cualquier $Q\in\mathcal{P}(I)$ y $c\in Q$. Si $P\in\mathcal{P}(I)$, tomando $Q=P\cup \{c\}$, $Q$ es un refinamiento de $P$, y por tanto, 

$$
\begin{gathered}
s(f,P) \leq s(f,Q) = s(f,Q_1) + s(f,Q_2) \leq \int_a^c f + \int_c^b f \\
\leq S(f,Q_1) + S(f,Q_2) = S(f,Q) \leq S(f,P),
\end{gathered}
$$

por lo que se concluye que $\int_a^b f = \int_a^c f + \int_c^b f$.

Para probar el otro sentido de la implicación, supongamos que $f$ es integrable en $[a,c]$ y $[c,b]$. Dado $\varepsilon>0$ existe $P_1\in\mathcal{P}([a,c])$ tal que $S(f,P_1)-s(f,P_1)<\frac{\varepsilon}{2}$ y existe $P_2\in\mathcal{P}([c,b])$ tal que $S(f,P_2)-s(f,P_2)<\frac{\varepsilon}{2}$. 

Tomando ahora $P=P_1\cup P_2\in \mathcal{P}(I)$, se cumple

$$
S(f,P)-s(f,P) = s(f,P_1) + S(f,P_2) - (s(f,P_1) + s(f,P_2)) < \frac{\varepsilon}{2}+\frac{\varepsilon}{2} =\varepsilon,
$$

por lo que $f$ es integrable en $I$.
:::
:::

A pesar de que la demostración es bastante larga, cuando $f$ es positiva, es obvio que el área entre la gráfica de $f$ y el eje $x$ en el intervalo $[a,b]$ puede descomponerse en la suma de las áreas en los intervalos $[a,c]$ y $[c,b]$ para cualquier $c\in(a,b)$.


:::{.content-visible when-format="html"}
![Aditividad de la integral respecto del intervalo de integración](img/integrales/aditividad-integral.png)
:::

:::{.content-visible unless-format="html"}
![Aditividad de la integral respecto del intervalo de integración](img/integrales/aditividad-integral.pdf)
:::


## Clase de las funciones integrables

A continuación trataremos de estudiar qué tipo de funciones son integrables.

:::{#thm-integrabilidad-funciones-monotonas}
Si $f:I\to\mathbb{R}$ es una función acotada y monótona en $I=[a,b]$, entonces  $f$ es integrable en $I$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Supongamos que $f$ es creciente en $I$. Dado $\varepsilon>0$ existe un $n\in\mathbb{N}$ tal que

$$
\frac{(f(b)-f(a))(b-a)}{n} < \varepsilon.
$$

Sea ahora $P_n\in\mathcal{P}(I)$ la partición que divide $I$ en $n$ subintervalos de igual longitud, es decir, $P=\{x_0, x_1, \ldots, x_n\}$ con $x_i = a+\frac{(b-a)i}{n}$.

Como $f$ es creciente en $I$ se tiene 

\begin{align*}
m_i &= \inf\{f(x): x\in[x_{i-1},x_i]\} = f(x_{i-1})\\
M_i &= \sup\{f(x): x\in[x_{i-1},x_i]\} = f(x_{i})
\end{align*}
para $i=1,\ldots,n$, de manera que 

\begin{align*}
S(f,P_n)-s(f,P_n) &= \sum_{i=1}^n f(x_i)(x_i-x_{i-1}) - \sum_{i=1}^n f(x_{i-1})(x_i-x_{i-1}) \\
&= \sum_{i=1}^n (f(x_i)-f(x_{i-1}))\frac{b-a}{n} \\
&= \frac{b-1}{n}(f(x_1)-f(x_0))+(f(x_2)-f(x_1))+ \cdots \\ 
& \cdots + (f(x_{n-1})-f(x_{n-2})+ (f(x_n)-f(x_{n-1}))) \\
&= \frac{b-a}{n}(f(b)-f(a)) < \varepsilon.
\end{align*}

Así pues, $f$ es integrable en $I$.
:::
:::

:::{#thm-integrabilidad-funciones-continuas}
Si $f:I\to\mathbb{R}$ es una función continua en $I=[a,b]$, entonces  $f$ es integrable en $I$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Observemos primero que como $f$ es continua en $I$, entonces es uniformemente continua en $I$ al ser $I$ un intervalo cerrado.

Dado $\varepsilon>0$, como $f$ es uniformemente continua en $I$, para $\varepsilon'=\frac{\varepsilon}{b-a}>0$ existe $\delta>0$ tal que si $|x-y|<\delta$ entonces $|f(x)-f(y)|<\varepsilon'$. 

Sea $P=\{x_0,x_1,\ldots,x_n\}$ una partición que divide $I$ en subintervalos de longitud menor que $\delta$. Entonces, para cad $i=1,\ldots, n$ se tiene 

$$
M_i-m_i = \sup\{|f(x)-f(y)|: x,y\in[x_{i-1},x_i]\} \leq \varepsilon',
$$
 
y por tanto,

\begin{align*}
S(f,P)-s(f,P) &= \sum_{i=1}^n M_i(x_i-x_{i-1}) - \sum_{i=1}^n m_i(x_i-x_{i-1}) \\
&= \sum_{i=1}^n (M_i-m_i)(x_i-x_{i-1})\\
& < \varepsilon' \sum_{i=1}^n (x_i-x_{i-1}) = \varepsilon' (b-a)  = \varepsilon.
\end{align*}
:::
:::

:::{#thm-integrabilidad-funciones-discontinuas}
Si $f:I\to\mathbb{R}$ es una función continua en $I=[a,b]$, salvo en un punto $c\in I$, entonces $f$ es integrable en $I$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Se deja como ejercicio.
:::
:::

:::{#cor-integrabilidad-funciones-discontinuas}
Si $f:I\to\mathbb{R}$ es una función continua en $I=[a,b]$, salvo en un conjunto finito de puntos de $I$, entonces $f$ es integrable en $I$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Haremos la prueba por inducción sobre el número de puntos de discontinuidad.

El caso para un solo punto de discontinuidad se ha probado en el teorema anterior. Supongamos que si $f$ tiene $n$ puntos de discontinuidad en $I$ entonces es integrable Riemann en $I$, y supongamos ahora que $f$ tiene $n+1$ puntos de discontinuidad. Sea $c$ el mayor de los puntos de discontinuidad. Tomando $\delta>0$ se tiene que $f$ tiene $n$ puntos de discontinuidad en el intervalo $[a, c-\delta]$, por lo que es integrable en este intervalo. 

Sea ahora $\varepsilon>0$. Como $f$ es integrable en $[a,c-\delta]$ existe una partición $P_1$ de $[a,c-\delta]$ tal que $S(f,P_1)-s(f,P_2)<\frac{\varepsilon}{2}$. Por otro lado, $f$ está acotada en el intervalo $[c-\delta, b]$ y solo tiene una discontinuidad, por el teorema anterior, $f$ es integrable en $[c-\delta,b]$, por lo que existe otra partición $P_2$ de $[c-\delta,b]$ tal que $S(f,P_2)-s(f,P_2)<\frac{\varepsilon}{2}$.

Tomando la partición $P=P_1\cup P_2$ que es un refinamiento de $P_1$ y $P_2$, se tiene

$$
S(f,P)-s(f,P)\leq S(f,P_1)+S(f,P_2)-s(f,P_1)-s(f,P_2) < \frac{\varepsilon}{2}+\frac{\varepsilon}{2} = \varepsilon.
$$

Por consiguiente $f$ es integrable Riemann con $n+1$ discontinuidades, y aplicando el principio de inducción queda probado el resultado.
:::
:::

:::{#thm-integrabilidad-composicion-funciones}
Si $f:I\to\mathbb{R}$ es una función integrable en $I=[a,b]$ y $g:J\to\mathbb{R}$ es una función continua en $J=[c,d]$ con $f(I)\subseteq J$, entonces $g\circ f$ es integrable en $I$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Como $g$ es continua en $J$, está acotada en $J$, de manera que podemos tomar $k>\sup\{g(x):x\in J\}-\inf\{f(x):x\in J\}$.

Por otro lado, como $J$ es cerrado, $g$ es uniformemente continua en $J$ y dado $\varepsilon>0$, existe $\delta<\varepsilon$ tal que si $|x-y|<\delta$ entonces $|g(x)-g(y)|<\frac{\varepsilon}{2(b-a)}$.

Como $f$ es integrable en $I$ podemos tomar una partición $P=\{x_0,x_1,\ldots,x_n\}$ de $I$, tal que 

$$
S(f,P)-s(f,P) < \frac{\delta^2}{2k}.
$$

Para $i=1,\ldots,n$, sea

\begin{align*}
m_i &= \inf\{f(x): x\in[x_{i-1},x_i]\}\\
M_i &= \sup\{f(x): x\in[x_{i-1},x_i]\}\\
m_i' &= \inf\{g\circ f(x): x\in[x_{i-1},x_i]\}\\
M_i' &= \sup\{g\circ f(x): x\in[x_{i-1},x_i]\}\\
\end{align*}

y sea

\begin{align*}
A &= \{i\in\{1,\ldots, n\}: M_i-m_i<\delta\}\\
B &= \{i\in\{1,\ldots, n\}: M_i-m_i\geq\delta\}
\end{align*}

Entonces se cumple que 

$$
\delta\sum_{i\in B} (x_i-x_{i-1}) \leq \sum_{i\in B} (M_i-m_i)(x_i-x_{i-1}) \leq \sum_{i=1}^n (M_i-m_i)(x_i-x_{i-1}) < \frac{\delta^2}{2k}
$$

de donde se deduce que 

$$
\sum_{i\in B} (x_i-x_{i-1}) < \frac{\delta}{2k}.
$$

Y utilizando los resultados anteriores se tiene

\begin{align*}
S(g\circ f,P)-s(g\circ f,P) &= \sum_{i\in A}(M_i'-m_i')(x_i-x_{i-1}) + \sum_{i\in B}(M_i'-m_i')(x_i-x_{i-1}) \\
&< \frac{\varepsilon}{2(b-a)} \sum_{i\in A}(x_i-x_{i-1}) + k \sum_{i\in B}(x_i-x_{i-1})\\
&< \frac{\varepsilon}{2}+\frac{\delta}{2} < \frac{\varepsilon}{2} + \frac{\varepsilon}{2} < \varepsilon,
\end{align*}

por lo que $g\circ f$ es integrable en $I$.
:::
:::

:::{#cor-integrabilidad-valor-absoluto}
Si $f:I\to\mathbb{R}$ es una función integrable en $I=[a,b]$, entonces la función $|f|$ es integrable en $I$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Como $f$ es integrable en $I$, $f$ está acotada en $I$, así que, tomando $c=\sup\{|f(x)|: x\in I\}$, basta aplicar el teorema anterior con $g=|x|$ en el intervalo $J=[-c,c]$.
:::
:::

:::{#cor-integrabilidad-potencias}
Si $f:I\to\mathbb{R}$ es una función integrable en $I=[a,b]$, entonces la función $f^n$ es integrable en $I$ para cualquier $n\in\mathbb{N}$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Como $f$ es integrable en $I$, $f$ está acotada en $I$, así que, tomando $c=\sup\{|f(x)|: x\in I\}$, basta aplicar el teorema anterior con $g=x^n$ en el intervalo $J=[-c,c]$.
:::
:::

:::{#cor-integrabilidad-funcion-inversa}
Si $f:I\to\mathbb{R}$ es una función integrable en $I=[a,b]$ tal que $f(x)>0$ $\forall x\in I$, entonces la función $\frac{1}{f}$ es integrable en $I$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Como $f$ es integrable en $I$, $f$ está acotada en $I$, así que, tomando $c=\inf\{f(x): x\in I\}$ y $d=\sup\{f(x): x\in I\}$, basta aplicar el teorema anterior con $g=\frac{1}{f}$ en el intervalo $J=[c,d]$.
:::
:::

:::{#cor-integrabilidad-funcion-inversa}
Si $f,g:I\to\mathbb{R}$ son dos funciones integrable en $I=[a,b]$, entonces la función $fg$ es integrable en $I$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Basta tener en cuenta los resultados anteriores y que 

$$
fg = \frac{1}{2}((f+g)^2-f^2-g^2)
$$
:::
:::

## Teorema fundamental del cálculo

En las secciones anteriores se ha definido la integral de Riemann y hemos estudiado los tipos de funciones integrables, pero, en general, el cálculo de integrales mediante sumas de Riemann suele ser complicado. En esta sección se presenta un importante teorema, al que llegaron Newton y Leibniz de manera simultánea, que relaciona el cálculo integral con el cálculo diferencial y que nos facilitará enormemente el cálculo de integrales sin tener que recurrir a la aproximación mediante sumas de Riemann. Este teorema es tan importante para el Análisis que se ha denominado _teorema fundamental del Cálculo_.

:::{#def-integral-indefinida}
Dada $f:I\to\mathbb{R}$ integrable en $I=[a,b]$, se define la _integral indefinida_ de $f$ en $I$ como la función 

$$
F(x) = \int_a^x f(t)\, dt
$$

$\forall x\in I$.
:::

Antes de enunciar el teorema, presentamos un resultado necesario para su demostración.

:::{#prp-integral-valor-absoluto}
Si $f:I\to\mathbb{R}$ integrable en $I=[a,b]$, entonces 

$$
\left|\int_a^b f(x)\,dx\right| \leq \int_a^b |f(x)|\,dx
$$ 
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Como $f$ es integrable en $I$, por el @cor-integrabilidad-valor-absoluto $|f|$ también es integrable en $I$.

Por otro lado, $-|f|\leq f \leq |f|$, y por las propiedades de la integral se tiene

$$
(-1)\int_a^b |f(x)|\,dx = \int_a^b -|f(x)|\,dx \leq \int_a^b f(x)\,dx \leq \int_a^b |f(x)|\,dx,
$$

de donde se deduce que 

$$
\left|\int_a^b f(x)\,dx\right| \leq \int_a^b |f(x)|\,dx.
$$
:::
:::

:::{#thm-integral-indefinida-continua}
Si $f:I\to\mathbb{R}$ integrable en $I=[a,b]$ y $F(x)=\int_a^x f(t)\,dt$ es la integral indefinida de $f$ en $I$, entonces $F$ es continua en $I$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Como $f$ es integrable en $I$, está acotada en $I$, así que sea $c=\sup\{|f(x)|: x\in I\}$.

Para cualquier $\varepsilon>0$ se puede tomar $\delta =\frac{\varepsilon}{c}>0$, de manera que si $x,y\in I$ con $x<y$ y $|x-y|<\delta$ se tiene, por la proposición anterior,

\begin{align*}
|F(y)-F(x)| 
& = \left|\int_a^y f(t)\,dt -\int_a^x f(t)\,dt\right| = \left|\int_x^y f(t)\,dt \right| \\
& \leq \int_x^y |f(t)|\,dt \leq c(y-x) < c\delta  = \varepsilon.
\end{align*}

Luego $F$ es uniformemente continua en $I$ y, por tanto, $F$ es continua en $I$.
:::
:::

:::{#exm-integral-indefinida-continua}
Sea 

$$
f(x)=
\begin{cases}
0 & \mbox{si $x\in [-1,0)$}\\
1 & \mbox{si $x\in [0,1]$}
\end{cases}
$$

$f$ es integrable pues es monótona, y su integral indefinida es

$$
F(x) = 
\begin{cases}
0 & \mbox{si $x\in [-1,0)$}\\
x & \mbox{si $x\in [0,1]$}
\end{cases}
$$

ya que para $0<x<1$ se tiene 

$$
F(x) = \int_{-1}^0 f + \int_0^x f = \int_0^x f = \int_0^1 1 = x.
$$
:::

Presentamos primero una primera versión del teorema fundamental del cálculo.

:::{#thm-teorema-fundamental-calculo-1}
## Teorema fundamental del Cálculo I
Dada $f:I\to\mathbb{R}$ integrable en $I=[a,b]$ y $F(x)=\int_a^x f(t)\,dt$ la integral indefinida de $f$ en $I$, si $f$ es continua en $c\in I$, entonces $F$ es derivable en $c$ y $F'(c)=f(c)$.
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Dado $\varepsilon>0$, como $f$ es continua en $c$, existe $\delta>0$ tal que si $x\in I$ y $|x-c|<\delta$, entonces $|f(x)-f(c)|<\varepsilon$.

Tomando $h\in\mathbb{R}$ con $|h|<\delta$ y tal que $c+h\in I$, se tiene

\begin{align*}
\left|\frac{F(c+h)-F(c)}{h}-f(c)\right| 
& = \left|\frac{\int_a^{c+h}f(t)\,dt -\int_a^c f(t)\,dt}{h} -f(c)\right| \\
& = \left|\left(\frac{1}{h}\int_c^{c+h}f(t)\,dt\right)-f(c)\right| \\
& = \left|\frac{1}{h}\left(\int_c^{c+h}f(t)\,dt - hf(c)\right)\right| \\
& = \left|\frac{1}{h}\left(\int_c^{c+h}f(t)\,dt - \int_c^{c+h} f(c)\,dt\right)\right|\\
& = \left|\frac{1}{h}\int_c^{c+h}(f(t)-f(c))\,dt\right| \\
& = \frac{1}{|h|} \left|\int_c^{c+h}(f(t)-f(c))\,dt\right|\\
& \leq \frac{1}{|h|} \varepsilon |h| = \varepsilon.
\end{align*}

Por tanto, $F'(c) = \lim_{h\to 0} \frac{F(c+h)-F(c)}{h} = f(c)$.
:::
:::

La importancia de este teorema radica en que conecta el concepto de derivada, al cuál se llegó mediante el estudio de las tangentes a la gráfica de una función, y el concepto de integral, al cuál hemos llegado mediante el estudio del área encerrada entre la gráfica de la función y el eje $x$. 

:::{.callout-warning}
Este teorema nos garantiza que si $f$ es continua en en el punto $c$, la integral indefinida $F$ es derivable en ese punto y su derivada coincide con $f(c)$, pero no nos permite calcular la integral definida, ya que, como veremos a continuación, existen infinitas funciones con derivada $f(c)$.
:::

:::{#def-primitiva}
## Primitiva de una función
Dada una función $f:I\to\ \mathbb{R}$ integrable en $I$, a cualquier función $F$ que cumple $F'=f$ se le llama _primitiva_ de $f$.
:::

:::{.callout-warning}
Si $F$ es una primitiva de $f$, entonces $f$ tiene infinitas primitivas, ya que $(F+C)' = F'+C' = F'+0 = F' = f$, y por tanto, $(F+C)$ también es una primitiva de $f$ $\forall C\in\mathbb{R}$. 
:::

:::{#exm-teorema-fundamental-calculo-alternativo}
Dada la función $f(x)=2x$, es fácil ver que $F(x)=x^2+C$ es una primitiva de $f$ para cualquier $C\in\mathbb{R}$. 

En el @exm-sumas-riemann vimos que $\int_0^1 x\,dx = \frac{1}{2}$, de modo que 
$$
\int_0^1 2x\,dx = 2 \int_0^1 x\,dx = 2\frac{1}{2} = 1.
$$

Si queremos llegar a este resultado usando primitivas, es necesario tomar la primitiva adecuada, es decir, necesitamos saber el valor concreto de la constante $C$ que permite calcular la integral definida. En este caso particular, como $F$ tiene que cumplir que $F(1)=1+C = 1=\int_0^1 2x\,dx$, resulta evidente que debe ser $C=0$, pero si tomamos cualquier otra constante, como por ejemplo $C=1$, entonces $F(1) = 1+1 = 2\neq 1 = \int_0^1 2x\,dx$. 
:::

Afortunadamente, la segunda parte del teorema fundamental del cálculo resuelve este inconveniente.

:::{#thm-teorema-fundamental-calculo-2}
## Teorema fundamental del cálculo II
Si $f:I\to\mathbb{R}$ es integrable en $I=[a,b]$ y $F$ es una primitiva de $f$ en $I$,  entonces

$$
\int_a^b f(x)\,dx = F(b)-F(a).
$$
:::

:::{.callout-note collapse="true"}
## Demostración
:::{.proof}
Dado $\varepsilon>0$, sea $P=\{x_0,x_1,\ldots,x_n\}$ una partición de $I$ tal que $S(f,P)-s(f,P)<\varepsilon$.

Como $F$ es continua en $I$, por el @thm-valor-medio, para $i=1,\ldots,n$, existe $t_i \in (x_i,x_{i+1})$ tal que 

$$
F(x_i)-F(x_{i-1}) = F'(t_i)(x_i-x_{i-1}) = f(t_i)(x_i-x_{i-1}).
$$

Entonces,

$$
\sum_{i=1}^n f(t_i)(x_i-x_{i-1}) = \sum_{i=1}^n (F(x_i)-F(x_{i-1})) = F(b)-F(a).
$$

Pero, 

$$
s(f,P)\leq \sum_{i=1}^n f(t_i)(x_i-x_{i-1}) \leq S(f,P),
$$

por lo que 

$$
\left|F(b)-F(a)-\int_a^b f(x)\,dx\right|<\varepsilon,
$$

y por tanto, 

$$
\int_a^b f(x)\,dx = F(b)-F(a).
$$
:::
:::

Este teorema, que también se conoce como al _regla de Barrow_, nos permitirá calcular la integral definida de una función a partir de cualquier primitiva suya, sin necesidad de usar las sumas de Riemann.

:::{#exm-regla-barrow}
Dada la función $f(x)=x^2$, la función $F_0(x)= \frac{x^3}{3}$ es una primitiva de $f$, y por tanto, podemos usarla para calcular la siguiente integral

$$
\int_0^1 x^2\, dx = F_0(1)-F_0(0) = \frac{1^3}{3}-\frac{0^3}{3} = \frac{1}{3}.
$$

Pero podríamos haber utilizado cualquier primitiva de $f$, como por ejemplo $F_1(x) = \frac{x^3}{3}+1$, ya que

$$
\int_0^1 x^2\, dx = F_1(1)-F_1(0) = \frac{1^3}{3}+1-\left(\frac{0^3}{3}+1\right) = \frac{1}{3}+1-1 = \frac{1}{3}.
$$
:::

:::{#exm-regla-barrow-2}
Dada la función $f(x)=\cos(x)$, la función $F(x)= \operatorname{sen}(x)$ es una primitiva de $f$, y por tanto, podemos usarla para calcular la siguiente integral

$$
\int_{\pi/2}^\pi \cos(x)\, dx = F(\pi)-F(\pi/2) = \operatorname{sen}(\pi)-\operatorname{sen}(\pi/2) = 0-1 = -1.
$$
:::

Hemos visto que si $f$ es continua en un intervalo $I=[a,b]$, entonces $f$ tiene primitiva en $I$, pero no toda función integrable en $I$ tiene primitiva.

:::{#exm-funcion-integrable-sin-primitiva}
La función 

$$
f(x) = 
\begin{cases}
1 & \mbox{si $x=1/2$}\\
0 & \mbox{si $x\in [0,1]\setminus\{1/2\}$}
\end{cases}
$$

es integrable en el intervalo $[0,1]$, y $\int_0^1 f(x)\,dx = 0$, sin embargo, $f$ no es continua en $[0,1]$ y no verifica el teorema de los valores intermedios, ya que  para cualquier $y\in(0,1/2)$, no existe $x\in[0,1/2]$ tal que $f(x)=y$. Por tanto, según el teorema de Darboux (@thm-darboux), $f$ no es la derivada de ninguna función en $[0,1]$, por lo que no tiene primitiva.
:::

También puede darse el caso de que $f$ tenga primitiva, y sin embargo, no sea integrable.

:::{#exm-funcion-no-integrable-con-primitiva}
La función 

$$
f(x)=
\begin{cases}
x^2\operatorname{sen}\left(\frac{1}{x^2}\right) & \mbox{si $x\in[-1,1]\setminus\{0\}$}\\
0 & \mbox{si $x=0$}
\end{cases}
$$

es derivable en cualquier punto de $[-1,1]$ y $f'(x) = 2x\operatorname{sen}\left(\frac{1}{x^2}\right)-\frac{2\cos\left(\frac{1}{^2}\right)}{x}$, que no está acotada en $[-1,1]$, y por tanto no es integrable en $[-1,1]$.
:::

## Cálculo de areas

Tal y como se ha definido la integral de una función a partir de las sumas de Riemann, no resulta extraño que la principal aplicación de las integrales definidas sea el cálculo del areas encerrada por la gráfica de una función y el eje $x$ en un intervalo de $I$. Ya hemos visto que cuando $f(x)\geq 0$ $\forall x\in I$, si $f$ es integrable en $I=[a,b]$, entonces $\int_a^b f(x)\, dx\geq 0$ es el área encerrada entre la gráfica de la función $f$ y el eje $x$ en el intervalo $I$. En esta sección veremos cómo calcular áreas de funciones que también presentan valores negativos en el intervalo de integración y generalizamos el resultado para calcular áreas encerradas entre las gráficas de dos funciones.

### Cálculo del area encerrada por una función y el eje $x$.

Ya hemos visto que cuando una función $f(x)<0$ $\forall x\in I=[a,b]$, entonces $\int_a^b f(x)\, dx<0$, de manera que no puede interpretarse como un área porque geométricamente no tienen sentido las áreas negativas. En general, para evitar este problema, si queremos calcular el área encerrada por la gráfica de una función $f(x)$ en un intervalo $I=[a,b]$ debemos calcular la integral definida en $I$ del valor absoluto de la función, es decir, 

$$
\int_a^b |f(x)|\,dx.
$$

Ahora bien, para calcular esta integral mediante primitivas, haciendo uso del teorema fundamental del cálculo, normalmente se recurre a descomponer el intervalo de integración en subintervalos donde la función sea positiva o negativa, integrar $f$ en los intervalos donde la función es positiva, integrar $-f$ en los intervalos donde la función es negativa, y finalmente, sumar las areas correspondientes a cada subintervalo.

:::{.content-visible when-format="html"}
![Area encerrada por una función positiva y negativa.](img/integrales/area-funcion-positiva-negativa-2.png)
:::

:::{.content-visible unless-format="html"}
![Area encerrada por una función positiva y negativa.](img/integrales/area-funcion-positiva-negativa-2.pdf)
:::

:::{#exm-area-funcion-positiva-negativa}
Veamos cómo calcular el area encerrada entre la gráfica de la función $f(x)=x^2-4x+3$ y el eje $x$ en el intervalo $[0,4]$.

Si resolvemos la ecuación $f(x)=0$ obtenemos dos raíces $x=1$ y $x=3$, de manera que la función es positiva en el intervalo $(0,1)$ y $(3,4)$ y negativa en el intervalo $(1,3)$. Por tanto, el área encerrada entre la gráfica de la función y el eje $x$ es 

\begin{align*}
\int_0^4 |f(x)|\,dx 
&= \int_0^1 x^2-4x+3\,dx -\int_1^3 x^2-4x+3\,dx + \int_3^4 x^2+4x+3\,dx\\
&= \left[\frac{x^3}{3}-2x^2+3x\right]_0^1 + \left[\frac{x^3}{3}-2x^2+3x\right]_1^3 + \left[\frac{x^3}{3}-2x^2+3x\right]_3^4 \\
&= \frac{4}{3} - \frac{-4}{3} + \frac{4}{3} = 4
\end{align*}

:::{.content-visible when-format="html"}
![Area encerrada por la parábola $f(x)=x^2-4x+3$.](img/integrales/area-parabola.png)
:::

:::{.content-visible unless-format="html"}
![Area encerrada por la parábola $f(x)=x^2-4x+3$.](img/integrales/area-parabola.pdf)
:::
:::

### Area encerrada entre dos funciones

Si en lugar de calcular el área encerrada entre la gráfica de una función $f$ y el eje $x$ en un intervalo $I=[a,b]$, se quiere calcular el area encerrada entre dos funciones $f$ y $g$ en un intervalo $I=[a,b]$, basta con integrar la diferencia entre las dos funciones $f-g$. Pero como $f$ puede ser mayor que $g$ en algún subintervalo de $I$ y menor en otros, para asegurarnos de calcular el area correcta, hay que integrar el valor absoluto de la diferencia, es decir,

$$
\int_a^b |f(x)-g(x)|\, dx
$$

Al igual que antes, para calcular esta integral mediante primitivas, haciendo uso del teorema fundamental del cálculo, tendremos que descomponer el intervalo de integración en subintervalos donde la diferencia $f-g$ sea sea positiva o negativa, integrar $f-g$ en los intervalos donde la diferencia es positiva, integrar $-(f-g)=g-f$ en los intervalos donde la diferencia es negativa, y finalmente, sumar las areas correspondientes a cada subintervalo.

:::{.content-visible when-format="html"}
![Area encerrada entre dos funciones.](img/integrales/area-entre-funciones.png)
:::

:::{.content-visible unless-format="html"}
![Area encerrada entre dos funciones.](img/integrales/area-entre-funciones.pdf)
:::

:::{#exm-area-funcion-positiva-negativa}
Veamos cómo calcular el area encerrada entre las gráficas de las funciones $f(x)=\operatorname{sen}(x)$ y $g(x)=\cos(x)$ en el intervalo $[0,\pi]$.

Si resolvemos la ecuación $f(x)-g(x)=0$ obtenemos una raíz en $x=\pi/4$ en el intervalo de integración. Se cumple que $f(x)<g(x)$ $\forall x\in\left(0,\frac{\pi}{4}\right)$ y $f(x)>g(x)$ $\forall x\in\left(\frac{\pi}{4},\pi\right)$. Por tanto, el área comprendida entre las gráficas de $f$ y $g$ en el intervalo $[0,\pi]$ es

\begin{align*}
\int_0^\pi |f(x)-g(x)|\,dx 
&= \int_0^{\pi/4} \cos(x)-\operatorname{sen}(x)\,dx +\int_{\pi/4}^{\pi} \operatorname{sen}(x)-\cos(x)\,dx\\
&= \left[\operatorname{sen}(x)+\cos(x)\right]_0^{\pi/4} + \left[-\cos(x)-\operatorname{sen}(x)\right]_{\pi/4}^{\pi} \\
&= \sqrt{2}-1 +\sqrt{2}+1 = 2\sqrt{2}
\end{align*}

:::{.content-visible when-format="html"}
![Area encerrada entre el seno y el coseno.](img/integrales/area-entre-seno-coseno.png)
:::

:::{.content-visible unless-format="html"}
![Area encerrada entre el seno y el coseno.](img/integrales/area-entre-seno-coseno.pdf)
:::
:::

### Cálculo del area encerrada por una curva en coordenadas polares

En ocasiones, para calcular el area encerrada por una curva, especialmente para curvas dadas mediante una ecuación implícita, resulta más sencillo trabajar en coordenadas polares. 

:::{.content-visible when-format="html"}
![Coordenadas polares.](img/integrales/coordenadas-polares.png)
:::

:::{.content-visible unless-format="html"}
![Coordenadas polares.](img/integrales/coordenadas-polares.pdf)
:::

Para pasar de coordenadas cartesianas a coordenadas polares, primero se obtiene el valor de $r$ aplicando el teorema de Pitágoras

$$
r = \sqrt{x^2+y^2}
$$

y después se obtiene el ángulo aplicando relaciones trigonométricas

$$
\theta =
\begin{cases}
\operatorname{arccos}\left(\frac{x}{r}\right) & \mbox{si $y\geq 0$}\\
-\operatorname{arccos}\left(\frac{x}{r}\right) & \mbox{si $y<0$}
\end{cases}
$$

suponiendo $r\neq 0$.

Y para pasar de coordenadas polares a coordenadas cartesianas se aplican las siguientes relaciones trigonométricas

\begin{align*}
x &= r \cos(\theta)\\
y &= r \operatorname{sen}(\theta)
\end{align*}

Para calcular el area encerrada por una curva dada en coordenadas polares $r=f(\theta)$ y las rectas $\theta=a$ y $\theta=b$, se puede utilizar una aproximación similar a las sumas de Riemann, descomponiendo el area en sectores de círculo con ángulos en una partición $P=\{\theta_0=a, \theta_1, \ldots, \theta_n=b\}$ de $I=[a,b]$. Si para cada uno de estos sectores se toma como radio el ínfimo de $f(\theta)$ en el correspondiente subintervalo, surgen las sumas inferiores

$$
s(f,P) = \sum_{i=1}^n \pi m_i^2\frac{(\theta_i-\theta_{i-1})}{2\pi} = \sum_{i=1}^n \frac{m_i^2}{2}(\theta_i-\theta_{i-1}) 
$$

donde $m_i=\inf\{f(\theta): \theta\in[\theta_{i-1},\theta_i]\}$ para $i=1,\ldots,n$.

Mientras que si para cada uno de estos sectores se toma como radio el supremo de $f(\theta)$ en el correspondiente subintervalo, surgen las sumas superiores

$$
S(f,P) = \sum_{i=1}^n \pi M_i^2\frac{(\theta_i-\theta_{i-1})}{2\pi} = \sum_{i=1}^n \frac{M_i^2}{2}(\theta_i-\theta_{i-1}) 
$$

donde $M_i=\sup\{f(\theta): \theta\in[\theta_{i-1},\theta_i]\}$ para $i=1,\ldots,n$.

:::{.content-visible when-format="html"}
![Descomposición en sectores de círculos del area encerrada por una curva en polares.](img/integrales/sumas-riemann-polares.png)
:::

:::{.content-visible unless-format="html"}
![Descomposición en sectores de círculos del area encerrada por una curva en polares.](img/integrales/sumas-riemann-polares.pdf)
:::

De forma análoga se puede definir _integral inferior_ de $f$ en $I$ como $\underline{\int_a^b} f =\sup\{s(f,P): P\in \mathcal{P}(I)\}$ y la _integral superior_ de $f$ en $I$ como el número $\overline{\int_a^b} f =\inf\{S(f,P): P\in \mathcal{P}(I)\}$, de manera que, si la integral inferior coincide con la superior, la función es integrable y 

$$
\int_a^b \frac{f(\theta)^2}{2}\,d\theta
$$

mide el área encerrada por la curva $r=f(\theta)$ y las rectas $\theta=a$ y $\theta=b$.

:::{.content-visible when-format="html"}
![Area encerrada por una curva en coordenadas polares.](img/integrales/integral-riemann-polares.png)
:::

:::{.content-visible unless-format="html"}
![Area encerrada por una curva en coordenadas polares.](img/integrales/integral-riemann-polares.pdf)
:::

:::{#exm-area-semicirculo-polares}
Un semicírculo de radio $r$ puede expresarse en coordenadas polares mediante la función $f(\theta)=r$ para $0\leq \theta\leq \pi$. Por tanto, el área encerrada por este semicírculo es 

$$
\int_0^{\pi} \frac{r^2}{2} \,d\theta = \left[\frac{r^2}{2}\theta\right]_0^\pi = \frac{r^2}{2}\pi.
$$.
:::

:::{#exm-area-curva-polar}
Veamos ahora cómo calcular el area encerrada por la curva polar $r=3\operatorname{sen}(2\theta)$.

$$
\int_0^{\pi} \frac{r^2}{2} \,d\theta = \left[\frac{r^2}{2}\theta\right]_0^\pi = \frac{r^2}{2}\pi.
$$.

:::{.content-visible when-format="html"}
![Area encerrada por la curva polar $r=3\operatorname{sen}(2\theta)$.](img/integrales/area-curva-polar.png)
:::

:::{.content-visible unless-format="html"}
![Area encerrada por la curva polar $r=3\operatorname{sen}(2\theta)$.](img/integrales/area-curva-polar.pdf)
:::
:::

### Cálculo del area encerrada por dos curvas en coordenadas polares

También es posible calcular el area encerrada por dos curvas en coordenadas polares de forma análoga a como se hizo para el area encerrada entre dos funciones en coordenadas cartesianas. 

Si tenemos dos curvas polares $r=f(\theta)$ y $r=g(\theta)$, con $f(\theta)\leq g(\theta)$ $\forall \theta\in[a,b]$, el area encerrada entre estas dos curvas en el intervalo $[a,b]$ puede calcularse restando el area encerrada por $g$ al area encerrada por $f$, es decir,

$$
\frac{1}{2} \int_a^b f(\theta)^2\,d\theta - \frac{1}{2} \int_a^b g(\theta)^2\,d\theta = \frac{1}{2} \int_a^b f(\theta)^2-g(\theta)^2\,d\theta
$$

:::{.content-visible when-format="html"}
![Area encerrada entre dos curvas polares$.](img/integrales/area-entre-curvas-polares.png)
:::

:::{.content-visible unless-format="html"}
![Area encerrada entre dos curvas polares$.](img/integrales/area-entre-curvas-polares.pdf)
:::

En general, cuando $f$ es mayor que $g$ en algunos subintervalos de $I$ y menor en otros, habrá que descomponer el intervalo de integración en subintervalos donde la diferencia $f-g$ sea sea positiva o negativa, integrar $f-g$ en los intervalos donde la diferencia es positiva, integrar $-(f-g)=g-f$ en los intervalos donde la diferencia es negativa, y finalmente, sumar las areas correspondientes a cada subintervalo.

:::{#exm-area-entre-curvas-polares}
Vamos a calcular el area encerrada entre las curvas polares $r=3\cos(\theta)$ y $r=1+\cos(\theta)$. Para ello primero debemos determinar el intervalo de integración a partir de los puntos de corte de las dos curvas. 

$$
3\cos(\theta) = 1 + \cos(\theta) \Leftrightarrow \cos(\theta) = \frac{1}{2} \Leftrightarrow \theta = \operatorname{arccos}\left(\frac{1}{2}\right) = \pm \frac{\pi}{6}
$$

Así pues, el intervalo de integración es $[-\frac{\pi}{6},\frac{\pi}{6}]$. Como en este intervalo $1+\cos(\theta) \leq 3\cos(\theta)$, el area encerrada entre estas dos curvas es

\begin{align*}
\frac{1}{2}\int_{-\pi/6}^{\pi/6}f(\theta)^2-g(\theta)^2\,d\theta 
&= \frac{1}{2} \int_{-\pi/6}^{\pi/6}(3\cos(\theta))^2 - (1+\cos(\theta))^2 \,d\theta \\
&= \frac{1}{2} \int_{-\pi/6}^{\pi/6}(8\cos(\theta))^2 - 2\cos(\theta) - 1 \,d\theta \\
&= \frac{1}{2}\left(8\int_{-\pi/6}^{\pi/6}\cos(\theta)^2\,d\theta - 2\int_{-\pi/6}^{\pi/6}\cos(\theta)\,d\theta - \int_{-\pi/6}^{\pi/6}\,d\theta \right) \\
&= \frac{1}{2}\left([2\operatorname{sen}(2\theta)+4\theta]_{-\pi/6}^{\pi/6} - 2[\operatorname{sen}(\theta)]_{-\pi/6}^{\pi/6} - [\theta]_{-\pi/6}^{\pi/6} \right) \\
&= \frac{1}{2}\left(\sqrt{3}+\frac{4\pi}{6} +\sqrt{3} +\frac{4\pi}{6}\right)\\
&= \frac{\pi}{2}+\sqrt{3}-1 \approx 2.3028
\end{align*}

:::{.content-visible when-format="html"}
![Area encerrada entre las curvas polares $r=3\cos(\theta)$ y $r=1+\cos(\theta)$.](img/integrales/area-entre-curvas-polares-2.png)
:::

:::{.content-visible unless-format="html"}
![Area encerrada entre las curvas polares $r=3\cos(\theta)$ y $r=1+\cos(\theta)$.](img/integrales/area-entre-curvas-polares-2.pdf)
:::
:::

## Integrales impropias

El concepto de integral definida de una función en un intervalo cerrado $[a,b$] y se puede generalizar a intervalos no acotados y también a funciones con discontinuidades de salto infinito.

:::{#def-integral-impropia-1}
## Integral impropia de primer tipo
Dada una función $f:I\to\mathbb{R}$ integrable en $I=[a,t]$ para $\forall t>a$, se define la _integral impropia_ de $f$ en el intervalo $[a,\infty)$ como el límite

$$
\int_a^\infty f(x)\,dx = \lim_{t\to\infty} \int_a^t f(x)\,dx
$$

siempre que este límite exista, en cuyo caso se dice que la integral impropia converge.

Del mismo modo, si $f$ es integrable en $I=[t,a]$ para $\forall t<a$, se define la _integral impropia_ de $f$ en el intervalo $(-\infty, a]$ como el límite

$$
\int_{-\infty}^a f(x)\,dx = \lim_{t\to\infty} \int_t^a f(x)\,dx.
$$

Finalmente, si $\int_{-\infty}^a f(x)\,dx$ y $\int_a^\infty f(x)\,dx$ convergen, se define la _integral impropia_ de $f$ en el intervalo $(-\infty, \infty)$ como

$$
\int_{-\infty}^\infty f(x)\,dx = \int_{-\infty}^a f(x)\,dx + \int_a^\infty f(x)\,dx
$$
:::

Para funciones positivas en los dominios de integración, estas integrales impropias pueden interpretarse también como áreas. En particular, $\int_a^\infty f(x)\,dx$ es el area encerrada por la gráfica de $f$ y el eje $x$ en el intervalo $[a,\infty)$, $\int_{-\infty}^\infty f(x)\,dx$ es el area encerrada por la gráfica de $f$ y el eje $x$ en el intervalo $(-\infty,a]$ y $\int_{-\infty}^\infty f(x)\,dx$ es el area encerrada por la gráfica de $f$ y el eje $x$ en todo $\mathbb{R}$.

:::{#exm-integrales-impropias-1}
La integral impropia de la función $f(x)=\frac{1}{x^2}$ converge en el intervalo $[1,\infty]$ ya que 

$$
\int_1^\infty \frac{1}{x^2}\,dx = \lim_{t\to\infty} \int_1^t \frac{1}{x^2}\,dx = \lim_{t\to\infty}\left[\frac{-1}{x}\right]_1^t = \lim_{n\to\infty} 1-\frac{1}{t} = 1.
$$

Por tanto, el área que queda encerrada por la gráfica de $f$ y el eje $x$ por encima de $1$ es finita y vale $1$.

Sin embargo, la integral impropia de la función $g(x)=\frac{1}{x}$ diverge en el intervalo $[1,\infty]$ ya que 

$$
\int_1^\infty \frac{1}{x}\,dx = \lim_{t\to\infty} \int_1^t \frac{1}{x}\,dx = \lim_{t\to\infty}\left[\ln(x)\right]_1^t = \lim_{n\to\infty} \ln(t) = \infty.
$$

Y por tanto, el área que queda encerrada por la gráfica de $g$ y el eje $x$ por encima de $1$ es infinita.
:::

En estos casos la región encerrada por la gráfica de la función y el eje $x$ se extiende de manera infinita a lo largo del eje $x$. La misma idea puede aplicarse para calcular areas de regiones encerradas por la gráfica de $f$ y el eje $y$ cuando estas regiones se extienden de manera infinita porque la función no está acotada en algún valor del dominio de integración.

:::{#def-integral-impropia-2}
## Integral impropia de segundo tipo
Dada una función $f:I\to\mathbb{R}$ continua en $I=[a,b)$ y discontinua en $b$, se define la _integral impropia_ de $f$ en $I$ como el límite

$$
\int_a^b f(x)\,dx = \lim_{t\to b^-} \int_a^t f(x)\,dx
$$

siempre que este límite exista, en cuyo caso se dice que la integral impropia converge.
:::

## Cálculo de volúmenes

Otra de las aplicaciones habituales de las integrales es el cálculo de volúmenes de cuerpos sólidos tridimensionales con secciones transversales regulares. El procedimiento es similar al utilizado para el cálculo de areas de regiones planas, pero en lugar de aproximar el area mediante sumas de Riemann de rectángulos, se utilizan sumas de Riemann de figuras geométricas de volumen conocido, habitualmente discos o envoltorios cilíndricos.
Para ello tomaremos secciones transversales del cuerpo sólido del que se quiere calcular el volumen con respecto a alguno de los ejes a lo largo de una partición del intervalo donde está definido el sólido en ese eje.

:::{.content-visible when-format="html"}
![Sección transversal de un cuerpo sólido con respecto al eje $x$](img/integrales/seccion-transversal-piramide.png)
:::

:::{.content-visible unless-format="html"}
![Sección transversal de un cuerpo sólido con respecto al eje $x$](img/integrales/seccion-transversal-piramide.pdf)
:::

En general, si disponemos de una función $A(x)$ que nos da el área de la sección transversal del sólido para cada $x\in[a,b]$, podemos tomar una partición $P_n=\{x_0=a,x_1,\ldots, x_n=b\}$ del intervalo $[a,b]$ y aproximar el volumen del sólido en este intervalo mediante las sumas inferior y superior de Riemann

\begin{align*}
s(A,P_n) &= \sum_{i=1}^n m_i(x_i-x_{i-1}),\quad m_i=\inf\{A(x): x\in(x_{i-1},x_i)\}\\
S(A,P_n) &= \sum_{i=1}^n M_i(x_i-x_{i-1}),\quad M_i=\sup\{A(x): x\in(x_{i-1},x_i)\}
\end{align*}

donde $m_i (x_i-x_{i-1})$ es el volumen de un cilindro de base $m_i$ y altura $x_i-x_{i-1}$, y $M_i (x_i-x_{i-1})$ es el volumen de un cilindro de base $M_i$ y altura $x_i-x_{i-1}$.

::: {.content-visible when-format="html"}
<div id="ggb-volumen-revolucion"></div>

<script>
var params = {
            "appName": "classic", 
            "width": 800, 
            "height": 800, 
            "showToolBar": false, 
            "showAlgebraInput": false, 
            "showMenuBar": false,
            "borderColor": "#FFFFFF",
            "enableRightClick": false,
            "enableLabelDrags": false,
            "enableShiftDragZoom": true,
            "showZoomButtons": false,
            "showResetIcon": true,
            "showFullscreenButton": true,
            "transparentGraphics": true,
            "material_id":"drndnm2u"
            };
    var ggbApplet2 = new GGBApplet(params, true);
    window.addEventListener("load", function() { 
        ggbApplet2.inject('ggb-volumen-revolucion');
    });
</script>
:::

Como ya hemos visto, si $\lim_{n\to\infty} s(A,P_n) = \lim_{n\to\infty} S(A,P_n)$, la función $A(x)$ es integrable Riemann en el intervalo $[a,b]$ y 

$$
\int_a^b A(x)\,dx = \lim_{n\to\infty} s(A,P_n) = \lim_{n\to\infty} S(A,P_n),
$$

mide el volumen del cuerpo sólido con secciones transversales de área $A(x)$ en el intervalo $[a,b]$.

:::{#exm-volumen-esfera}
Veamos cómo calcular el volumen de una esfera de radio $r$ centrada en el origen con ecuación $x^2+y^2+z^2=r^2$. Si cortamos la esfera con planos $x=x_i$ perpendiculares al eje $x$, sustituyendo en la ecuación de la esfera, se tiene $y^2+z^2=r^2-x_i^2$, por lo que se obtienen secciones transversales circulares con radio $\sqrt{r^2-x_i^2}$, y, por tanto, el área de estas secciones circulares será $\pi \left(\sqrt{r^2-x_i^2}\right)^2= \pi (r^2-x_i^2)$. Así pues, la función que nos da el área de la sección transversal para cualquier $x\in[-r,r]$ es $A(x)=\pi(r^2-x^2)$, y por tanto, podemos calcular el volumen de la esfera con la integral definida

\begin{align*}
\int_{-r}^r \pi(r^2-x^2)\,dx 
&= \pi\left[r^2x-\frac{x^3}{3}\right]_{-r}^r \\
&= \pi\left(r^2r-\frac{r^3}{3}-\left(r^2(-r)-\frac{(-r)^3}{3}\right)\right) \\
&= 2r^3 - \frac{2r^3}{3} 
= \frac{4}{3}\pi r^3.
\end{align*}
:::

### Cálculo de volúmenes de sólidos de revolución

Cuando el sólido se obtiene rotando una función $f(x)$ alrededor del eje $x$, se dice que el sólido resultante es un _sólido de revolución_. Este tipo de sólidos tiene la particularidad de que todas sus secciones transversales con respecto al eje de rotación son círculos de radio $f(x)$, por lo que el área de las secciones transversales es $A(x)=\pi f(x)^2$, y su volumen en el intervalo $[a,b]$ puede calcularse mediante la integral definida

$$
\int_a^b \pi f(x)^2\,dx
$$

:::{#exm-volumen-cono-revolucion}
Si rotamos alrededor del eje $x$ el segmento de la recta $f(x)=2-x$ correspondiente al intervalo $x\in[0,2]$, se obtiene un cono con base de radio $2$ y altura $2$. El volumen de este cono es

\begin{align*}
\int_0^2 \pi f(x)^2\,dx 
&= \int_0^2 \pi (2-x)^2\,dx 
= \pi \int_0^2 x^2-4x+4\,dx \\
&= \pi \left[\frac{x^3}{3}-2x^2+4x\right]_0^2
= \pi\left(\frac{2^3}{3}-2\cdot 2^2+4\cdot 2\right) 
= \frac{8}{3}\pi.
\end{align*}
:::

### Cálculo de volúmenes con envoltorios cilíndricos

Otra forma de calcular volúmenes de sólidos de revolución es mediante envoltorios cilíndricos como los de figura de mas abajo. 

El envoltorio cilíndrico para un valor $x$ cualquiera tiene un area dada por $2\pi x f(x)$, de manera que sumando estas infinitas áreas, se puede llegar al volumen del cuerpo sólido en el intervalo $[a,b]$ mediante la integral definida

$$
\int_a^b 2\pi x f(x)\,dx
$$

::: {.content-visible when-format="html"}
<div id="ggb-volumen-revolucion-envoltorios"></div>

<script>
var params = {
            "appName": "classic", 
            "width": 800, 
            "height": 800, 
            "showToolBar": false, 
            "showAlgebraInput": false, 
            "showMenuBar": false,
            "borderColor": "#FFFFFF",
            "enableRightClick": false,
            "enableLabelDrags": false,
            "enableShiftDragZoom": true,
            "showZoomButtons": true,
            "showResetIcon": true,
            "showFullscreenButton": true,
            "transparentGraphics": true,
            "material_id":"bcpdxmpf"
            };
    var ggbApplet3 = new GGBApplet(params, true);
    window.addEventListener("load", function() { 
        ggbApplet3.inject('ggb-volumen-revolucion-envoltorios');
    });
</script>
:::